{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7214,"status":"ok","timestamp":1692536474834,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Yk9cUFqi-w4N","outputId":"7930d2ad-69ad-4da0-8804-95b8ea414fdb"},"outputs":[{"name":"stdout","output_type":"stream","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14299,"status":"ok","timestamp":1692536489126,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"GnRdxieR_JZ1","outputId":"09e451cd-60f2-4c29-f042-ea27e12ec7f6"},"outputs":[{"name":"stdout","output_type":"stream","text":["Requirement already satisfied: sktime in /usr/local/lib/python3.10/dist-packages (0.22.0)\n","Requirement already satisfied: numpy\u003c1.26,\u003e=1.21.0 in /usr/local/lib/python3.10/dist-packages (from sktime) (1.23.5)\n","Requirement already satisfied: pandas\u003c2.1.0,\u003e=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sktime) (1.5.3)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from sktime) (23.1)\n","Requirement already satisfied: scikit-base\u003c0.6.0 in /usr/local/lib/python3.10/dist-packages (from sktime) (0.5.1)\n","Requirement already satisfied: scikit-learn\u003c1.4.0,\u003e=0.24.0 in /usr/local/lib/python3.10/dist-packages (from sktime) (1.2.2)\n","Requirement already satisfied: scipy\u003c2.0.0,\u003e=1.2.0 in /usr/local/lib/python3.10/dist-packages (from sktime) (1.10.1)\n","Requirement already satisfied: python-dateutil\u003e=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas\u003c2.1.0,\u003e=1.1.0-\u003esktime) (2.8.2)\n","Requirement already satisfied: pytz\u003e=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas\u003c2.1.0,\u003e=1.1.0-\u003esktime) (2023.3)\n","Requirement already satisfied: joblib\u003e=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn\u003c1.4.0,\u003e=0.24.0-\u003esktime) (1.3.2)\n","Requirement already satisfied: threadpoolctl\u003e=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn\u003c1.4.0,\u003e=0.24.0-\u003esktime) (3.2.0)\n","Requirement already satisfied: six\u003e=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil\u003e=2.8.1-\u003epandas\u003c2.1.0,\u003e=1.1.0-\u003esktime) (1.16.0)\n"]}],"source":["!pip install sktime"]},{"cell_type":"code","execution_count":3,"metadata":{"executionInfo":{"elapsed":3344,"status":"ok","timestamp":1692536492452,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"xpCHEEEF_NM9"},"outputs":[],"source":["from lightgbm import LGBMRegressor, early_stopping\n","from xgboost import XGBRegressor, callback\n","\n","from sklearn.model_selection import KFold\n","from sklearn.preprocessing import OneHotEncoder\n","\n","from sktime.forecasting.model_selection import temporal_train_test_split\n","import matplotlib.pyplot as plt\n","from sklearn.metrics import make_scorer"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"executionInfo":{"elapsed":2606,"status":"ok","timestamp":1692536495050,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"eaZk-K-X_OEb","outputId":"a068f2e8-2a3d-4bef-986f-cac4595b027e"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'cpu'"]},"execution_count":4,"metadata":{},"output_type":"execute_result"}],"source":["import pandas as pd\n","import numpy as np\n","import torch\n","from tqdm.auto import tqdm\n","import random\n","import os\n","\n","def reset_seeds(seed):\n","    random.seed(seed)\n","    os.environ['PYTHONHASHSEED'] = str(seed)\n","    np.random.seed(seed)\n","    torch.manual_seed(seed)\n","    torch.cuda.manual_seed(seed)\n","    torch.backends.cudnn.deterministic = True\n","\n","DATA_PATH = '/content/drive/MyDrive/데이콘 캐글 컴페티션/DACON_23.07_PowerConsumption/'\n","SEED = 42\n","\n","device = 'cuda' if torch.cuda.is_available() else 'cpu'\n","device"]},{"cell_type":"code","execution_count":5,"metadata":{"executionInfo":{"elapsed":27330,"status":"ok","timestamp":1692536522375,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tGdQA8_y_Ryz"},"outputs":[],"source":["train = pd.read_csv(f\"{DATA_PATH}train.csv\")\n","test = pd.read_csv(f\"{DATA_PATH}test.csv\")\n","building = pd.read_csv(f\"{DATA_PATH}building_info.csv\")\n","submission = pd.read_csv(f\"{DATA_PATH}sample_submission.csv\")\n","\n","df = pd.read_csv(f\"{DATA_PATH}train_featured_3.csv\")\n","train_ft = pd.read_csv(f\"{DATA_PATH}train_selected_3.csv\")\n","\n","test_df = pd.read_csv(f\"{DATA_PATH}test_featured_3.csv\")\n","test_ft = pd.read_csv(f\"{DATA_PATH}test_selected_3.csv\")"]},{"cell_type":"code","execution_count":6,"metadata":{"executionInfo":{"elapsed":1285,"status":"ok","timestamp":1692536522376,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Ca2xNFab_yVh"},"outputs":[],"source":["def _smape(true, pred):\n","    true = np.array(true)\n","    pred = np.array(pred)\n","    output = np.mean((np.abs(true-pred))/(np.abs(true) + np.abs(pred))) * 100\n","    return output\n","smape = make_scorer(_smape, greater_is_better=False)"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1273,"status":"ok","timestamp":1692536522376,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"k7IdP6Cl_jNh","outputId":"eae7e1e0-bf78-47b1-81b3-4e712a16efa4"},"outputs":[{"data":{"text/plain":["Index(['day_hour_mean', 'day_hour_median', 'discomfort_CDH', 'week',\n","       'day_hour_mode', 'discomfort', 'day_hour_std', 'CDH', 'hour_mean',\n","       'sin_time', 'cos_week', 'day_of_year'],\n","      dtype='object')"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["train_ft.columns"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1215,"status":"ok","timestamp":1692536522380,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"l8MS4nSs_mUx","outputId":"0855a1c7-20e0-4b71-b12d-41ed5ad47d59"},"outputs":[{"data":{"text/plain":["Index(['num_date_time', 'building_num', 'date_time', 'temp', 'precip',\n","       'wind_ms', 'humidity', 'sunshine', 'solar_rad', 'energy_consum',\n","       'building_type', 'floor_area', 'cooling_area', 'solar_capa', 'ess_capa',\n","       'pcs_capa', 'hour', 'day', 'month', 'week', 'day_hour_mean',\n","       'hour_mean', 'hour_std', 'hour_type_mean', 'holiday', 'sin_time',\n","       'cos_time', 'THI', 'CDH', 'discomfort', 'discomfort_CDH', 'solar_gen',\n","       'CDH_solar', 'cooling_ratio', 'day_of_year', 'cos_day_of_year',\n","       'sin_day_of_year', 'cos_weekday', 'sin_weekday', 'cos_week', 'sin_week',\n","       'cos_month', 'sin_month', 'day_hour_median', 'day_hour_std',\n","       'day_hour_mode'],\n","      dtype='object')"]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"source":["df.columns"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1192,"status":"ok","timestamp":1692536522380,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_r5gGqi-4yOc","outputId":"1fe9114c-f709-4d62-d37f-777567cded5a"},"outputs":[{"data":{"text/plain":["Index(['num_date_time', 'building_num', 'date_time', 'temp', 'precip',\n","       'wind_ms', 'humidity', 'building_type', 'floor_area', 'cooling_area',\n","       'solar_capa', 'ess_capa', 'pcs_capa', 'hour', 'day', 'month', 'week',\n","       'day_hour_mean', 'discomfort', 'discomfort_CDH', 'day_hour_median',\n","       'day_hour_mode', 'day_hour_std', 'sin_time', 'hour_mean', 'CDH',\n","       'day_of_year', 'cos_week', 'THI'],\n","      dtype='object')"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["test_df.columns"]},{"cell_type":"code","execution_count":10,"metadata":{"executionInfo":{"elapsed":1166,"status":"ok","timestamp":1692536522381,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"nACvHOhu_9j3"},"outputs":[],"source":["features = ['energy_consum', 'day_hour_mean', 'discomfort_CDH', 'week','sin_time', 'cos_week',\n","       'THI', 'hour', 'day', 'wind_ms', 'temp', 'month', 'humidity','precip','building_num']\n","\n","\n","train_ft = df[features]"]},{"cell_type":"markdown","metadata":{"id":"cBRqJSLoyKp9"},"source":[]},{"cell_type":"code","execution_count":10,"metadata":{"executionInfo":{"elapsed":1157,"status":"ok","timestamp":1692536522381,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ImBJ8sQS6DIA"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"elapsed":1144,"status":"ok","timestamp":1692536522381,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"niF_7WL84vrn"},"outputs":[],"source":["features = ['day_hour_mean', 'discomfort_CDH', 'week','sin_time', 'cos_week',\n","      'THI', 'hour', 'day', 'wind_ms', 'temp', 'month', 'humidity','precip', 'building_num']\n","\n","test_ft = test_df[features]"]},{"cell_type":"code","execution_count":12,"metadata":{"executionInfo":{"elapsed":1143,"status":"ok","timestamp":1692536522381,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"7gb5yakgzQsK"},"outputs":[],"source":["train_ft = train_ft.fillna(0)"]},{"cell_type":"code","execution_count":18,"metadata":{"executionInfo":{"elapsed":69,"status":"ok","timestamp":1692536686294,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"iD2Sw3UMCG5Z"},"outputs":[],"source":["#df : full feature\n","\n","# 1부터 36까지의 숫자에 따라 train_ft 데이터프레임을 생성하여 개별 변수로 저장\n","for i in range(1, 101):\n","    globals()[f'train_df_{i}'] = df[df['building_num'] == i]"]},{"cell_type":"code","execution_count":19,"metadata":{"executionInfo":{"elapsed":68,"status":"ok","timestamp":1692536686294,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"mn9JRnUeAyV3"},"outputs":[],"source":["#test_ft\n","\n","# 1부터 36까지의 숫자에 따라 test_ft 데이터프레임을 생성하여 개별 변수로 저장\n","for i in range(1, 101):\n","    globals()[f'test_df_{i}'] = test_ft[test_ft['building_num'] == i]"]},{"cell_type":"markdown","metadata":{"id":"fL_vaGevAXM3"},"source":["## 1"]},{"cell_type":"code","execution_count":19,"metadata":{"executionInfo":{"elapsed":70,"status":"ok","timestamp":1692536686295,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pjvK6O2A1EyS"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":20,"metadata":{"executionInfo":{"elapsed":69,"status":"ok","timestamp":1692536686297,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"FyZUwq_WAWx5"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":21,"metadata":{"executionInfo":{"elapsed":69,"status":"ok","timestamp":1692536686297,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"su4Ffmr2ArRY"},"outputs":[],"source":["train_x = train_ft_1.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_1['energy_consum']\n","\n","test_x = test_df_1.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":22,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":68,"status":"ok","timestamp":1692536686297,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Wls3JVA8A_Qr","outputId":"741bfd29-370e-412f-aa5d-7bd83b58036f"},"outputs":[{"data":{"text/plain":["((1872, 13), (168, 13), (1872,), (168,))"]},"execution_count":22,"metadata":{},"output_type":"execute_result"}],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":23,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":443},"executionInfo":{"elapsed":48,"status":"ok","timestamp":1692536686298,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1tzTyYuT3VhQ","outputId":"40a6dba0-47c1-475a-f22a-2030d56fe129"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-6a9f735e-e8e4-4390-8adb-f159875e1309\" class=\"colab-df-container\"\u003e\n","    \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eenergy_consum\u003c/th\u003e\n","      \u003cth\u003eday_hour_mean\u003c/th\u003e\n","      \u003cth\u003ediscomfort_CDH\u003c/th\u003e\n","      \u003cth\u003eweek\u003c/th\u003e\n","      \u003cth\u003esin_time\u003c/th\u003e\n","      \u003cth\u003ecos_week\u003c/th\u003e\n","      \u003cth\u003eTHI\u003c/th\u003e\n","      \u003cth\u003ehour\u003c/th\u003e\n","      \u003cth\u003eday\u003c/th\u003e\n","      \u003cth\u003ewind_ms\u003c/th\u003e\n","      \u003cth\u003etemp\u003c/th\u003e\n","      \u003cth\u003emonth\u003c/th\u003e\n","      \u003cth\u003ehumidity\u003c/th\u003e\n","      \u003cth\u003eprecip\u003c/th\u003e\n","      \u003cth\u003ebuilding_num\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e1085.28\u003c/td\u003e\n","      \u003ctd\u003e1774.744615\u003c/td\u003e\n","      \u003ctd\u003e37.09388\u003c/td\u003e\n","      \u003ctd\u003e22\u003c/td\u003e\n","      \u003ctd\u003e0.000000\u003c/td\u003e\n","      \u003ctd\u003e-1.000000\u003c/td\u003e\n","      \u003ctd\u003e49.6576\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e0.9\u003c/td\u003e\n","      \u003ctd\u003e18.6\u003c/td\u003e\n","      \u003ctd\u003e6\u003c/td\u003e\n","      \u003ctd\u003e42.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e1047.36\u003c/td\u003e\n","      \u003ctd\u003e1687.347692\u003c/td\u003e\n","      \u003ctd\u003e73.55788\u003c/td\u003e\n","      \u003ctd\u003e22\u003c/td\u003e\n","      \u003ctd\u003e0.258819\u003c/td\u003e\n","      \u003ctd\u003e-1.000000\u003c/td\u003e\n","      \u003ctd\u003e47.7625\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e1.1\u003c/td\u003e\n","      \u003ctd\u003e18.0\u003c/td\u003e\n","      \u003ctd\u003e6\u003c/td\u003e\n","      \u003ctd\u003e45.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e974.88\u003c/td\u003e\n","      \u003ctd\u003e1571.483077\u003c/td\u003e\n","      \u003ctd\u003e109.64523\u003c/td\u003e\n","      \u003ctd\u003e22\u003c/td\u003e\n","      \u003ctd\u003e0.500000\u003c/td\u003e\n","      \u003ctd\u003e-1.000000\u003c/td\u003e\n","      \u003ctd\u003e47.2225\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e1.5\u003c/td\u003e\n","      \u003ctd\u003e17.7\u003c/td\u003e\n","      \u003ctd\u003e6\u003c/td\u003e\n","      \u003ctd\u003e45.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e953.76\u003c/td\u003e\n","      \u003ctd\u003e1522.153846\u003c/td\u003e\n","      \u003ctd\u003e144.54407\u003c/td\u003e\n","      \u003ctd\u003e22\u003c/td\u003e\n","      \u003ctd\u003e0.707107\u003c/td\u003e\n","      \u003ctd\u003e-1.000000\u003c/td\u003e\n","      \u003ctd\u003e44.7856\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e1.4\u003c/td\u003e\n","      \u003ctd\u003e16.7\u003c/td\u003e\n","      \u003ctd\u003e6\u003c/td\u003e\n","      \u003ctd\u003e48.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e986.40\u003c/td\u003e\n","      \u003ctd\u003e1506.793846\u003c/td\u003e\n","      \u003ctd\u003e181.43195\u003c/td\u003e\n","      \u003ctd\u003e22\u003c/td\u003e\n","      \u003ctd\u003e0.866025\u003c/td\u003e\n","      \u003ctd\u003e-1.000000\u003c/td\u003e\n","      \u003ctd\u003e49.0061\u003c/td\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e2.8\u003c/td\u003e\n","      \u003ctd\u003e18.4\u003c/td\u003e\n","      \u003ctd\u003e6\u003c/td\u003e\n","      \u003ctd\u003e43.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2035\u003c/th\u003e\n","      \u003ctd\u003e2517.12\u003c/td\u003e\n","      \u003ctd\u003e2571.470769\u003c/td\u003e\n","      \u003ctd\u003e101120.62603\u003c/td\u003e\n","      \u003ctd\u003e34\u003c/td\u003e\n","      \u003ctd\u003e-0.965926\u003c/td\u003e\n","      \u003ctd\u003e-0.568065\u003c/td\u003e\n","      \u003ctd\u003e60.1141\u003c/td\u003e\n","      \u003ctd\u003e19\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e2.9\u003c/td\u003e\n","      \u003ctd\u003e25.5\u003c/td\u003e\n","      \u003ctd\u003e8\u003c/td\u003e\n","      \u003ctd\u003e63.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2036\u003c/th\u003e\n","      \u003ctd\u003e2208.96\u003c/td\u003e\n","      \u003ctd\u003e2391.027692\u003c/td\u003e\n","      \u003ctd\u003e101168.07303\u003c/td\u003e\n","      \u003ctd\u003e34\u003c/td\u003e\n","      \u003ctd\u003e-0.866025\u003c/td\u003e\n","      \u003ctd\u003e-0.568065\u003c/td\u003e\n","      \u003ctd\u003e59.6464\u003c/td\u003e\n","      \u003ctd\u003e20\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e2.6\u003c/td\u003e\n","      \u003ctd\u003e25.0\u003c/td\u003e\n","      \u003ctd\u003e8\u003c/td\u003e\n","      \u003ctd\u003e66.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2037\u003c/th\u003e\n","      \u003ctd\u003e1806.24\u003c/td\u003e\n","      \u003ctd\u003e1887.950769\u003c/td\u003e\n","      \u003ctd\u003e101215.03521\u003c/td\u003e\n","      \u003ctd\u003e34\u003c/td\u003e\n","      \u003ctd\u003e-0.707107\u003c/td\u003e\n","      \u003ctd\u003e-0.568065\u003c/td\u003e\n","      \u003ctd\u003e59.1101\u003c/td\u003e\n","      \u003ctd\u003e21\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e1.3\u003c/td\u003e\n","      \u003ctd\u003e24.6\u003c/td\u003e\n","      \u003ctd\u003e8\u003c/td\u003e\n","      \u003ctd\u003e67.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2038\u003c/th\u003e\n","      \u003ctd\u003e1387.20\u003c/td\u003e\n","      \u003ctd\u003e1412.861538\u003c/td\u003e\n","      \u003ctd\u003e101261.54751\u003c/td\u003e\n","      \u003ctd\u003e34\u003c/td\u003e\n","      \u003ctd\u003e-0.500000\u003c/td\u003e\n","      \u003ctd\u003e-0.568065\u003c/td\u003e\n","      \u003ctd\u003e58.8800\u003c/td\u003e\n","      \u003ctd\u003e22\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e2.1\u003c/td\u003e\n","      \u003ctd\u003e24.1\u003c/td\u003e\n","      \u003ctd\u003e8\u003c/td\u003e\n","      \u003ctd\u003e70.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2039\u003c/th\u003e\n","      \u003ctd\u003e1925.28\u003c/td\u003e\n","      \u003ctd\u003e1698.240000\u003c/td\u003e\n","      \u003ctd\u003e101307.60891\u003c/td\u003e\n","      \u003ctd\u003e34\u003c/td\u003e\n","      \u003ctd\u003e-0.258819\u003c/td\u003e\n","      \u003ctd\u003e-0.568065\u003c/td\u003e\n","      \u003ctd\u003e58.3400\u003c/td\u003e\n","      \u003ctd\u003e23\u003c/td\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e1.4\u003c/td\u003e\n","      \u003ctd\u003e23.8\u003c/td\u003e\n","      \u003ctd\u003e8\u003c/td\u003e\n","      \u003ctd\u003e70.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e2040 rows × 15 columns\u003c/p\u003e\n","\u003c/div\u003e\n","    \u003cdiv class=\"colab-df-buttons\"\u003e\n","\n","  \u003cdiv class=\"colab-df-container\"\u003e\n","    \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6a9f735e-e8e4-4390-8adb-f159875e1309')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\"\u003e\n","\n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\"\u003e\n","    \u003cpath d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/\u003e\n","  \u003c/svg\u003e\n","    \u003c/button\u003e\n","\n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","    \u003cscript\u003e\n","      const buttonEl =\n","        document.querySelector('#df-6a9f735e-e8e4-4390-8adb-f159875e1309 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-6a9f735e-e8e4-4390-8adb-f159875e1309');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    \u003c/script\u003e\n","  \u003c/div\u003e\n","\n","\n","\u003cdiv id=\"df-a0379459-c7cb-41d8-b505-0d6048cf23ff\"\u003e\n","  \u003cbutton class=\"colab-df-quickchart\" onclick=\"quickchart('df-a0379459-c7cb-41d8-b505-0d6048cf23ff')\"\n","            title=\"Suggest charts.\"\n","            style=\"display:none;\"\u003e\n","\n","\u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\"\u003e\n","    \u003cg\u003e\n","        \u003cpath d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/\u003e\n","    \u003c/g\u003e\n","\u003c/svg\u003e\n","  \u003c/button\u003e\n","\n","\u003cstyle\u003e\n","  .colab-df-quickchart {\n","    background-color: #E8F0FE;\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: #1967D2;\n","    height: 32px;\n","    padding: 0 0 0 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: #E2EBFA;\n","    box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: #174EA6;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","    background-color: #3B4455;\n","    fill: #D2E3FC;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart:hover {\n","    background-color: #434B5C;\n","    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","    fill: #FFFFFF;\n","  }\n","\u003c/style\u003e\n","\n","  \u003cscript\u003e\n","    async function quickchart(key) {\n","      const charts = await google.colab.kernel.invokeFunction(\n","          'suggestCharts', [key], {});\n","    }\n","    (() =\u003e {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-a0379459-c7cb-41d8-b505-0d6048cf23ff button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  \u003c/script\u003e\n","\u003c/div\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n"],"text/plain":["      energy_consum  day_hour_mean  discomfort_CDH  week  sin_time  cos_week  \\\n","0           1085.28    1774.744615        37.09388    22  0.000000 -1.000000   \n","1           1047.36    1687.347692        73.55788    22  0.258819 -1.000000   \n","2            974.88    1571.483077       109.64523    22  0.500000 -1.000000   \n","3            953.76    1522.153846       144.54407    22  0.707107 -1.000000   \n","4            986.40    1506.793846       181.43195    22  0.866025 -1.000000   \n","...             ...            ...             ...   ...       ...       ...   \n","2035        2517.12    2571.470769    101120.62603    34 -0.965926 -0.568065   \n","2036        2208.96    2391.027692    101168.07303    34 -0.866025 -0.568065   \n","2037        1806.24    1887.950769    101215.03521    34 -0.707107 -0.568065   \n","2038        1387.20    1412.861538    101261.54751    34 -0.500000 -0.568065   \n","2039        1925.28    1698.240000    101307.60891    34 -0.258819 -0.568065   \n","\n","          THI  hour  day  wind_ms  temp  month  humidity  precip  building_num  \n","0     49.6576     0    2      0.9  18.6      6      42.0     0.0             1  \n","1     47.7625     1    2      1.1  18.0      6      45.0     0.0             1  \n","2     47.2225     2    2      1.5  17.7      6      45.0     0.0             1  \n","3     44.7856     3    2      1.4  16.7      6      48.0     0.0             1  \n","4     49.0061     4    2      2.8  18.4      6      43.0     0.0             1  \n","...       ...   ...  ...      ...   ...    ...       ...     ...           ...  \n","2035  60.1141    19    2      2.9  25.5      8      63.0     0.0             1  \n","2036  59.6464    20    2      2.6  25.0      8      66.0     0.0             1  \n","2037  59.1101    21    2      1.3  24.6      8      67.0     0.0             1  \n","2038  58.8800    22    2      2.1  24.1      8      70.0     0.0             1  \n","2039  58.3400    23    2      1.4  23.8      8      70.0     0.0             1  \n","\n","[2040 rows x 15 columns]"]},"execution_count":23,"metadata":{},"output_type":"execute_result"}],"source":["train_ft_1.fillna(0)"]},{"cell_type":"code","execution_count":24,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":45,"status":"ok","timestamp":1692536686298,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"49Un4ymY3xYK","outputId":"01b2f781-a70b-4057-f77f-fd05e09d8840"},"outputs":[{"data":{"text/plain":["0"]},"execution_count":24,"metadata":{},"output_type":"execute_result"}],"source":["train_ft_1.isna().sum().sum()"]},{"cell_type":"code","execution_count":24,"metadata":{"executionInfo":{"elapsed":36,"status":"ok","timestamp":1692536686299,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"v-aZWL9c6p1M"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":25,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":178},"executionInfo":{"elapsed":35,"status":"ok","timestamp":1692536686299,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"u7-5x6DuBRbr","outputId":"5972e54c-d861-4aa7-d2ca-c4de80854f9a"},"outputs":[{"name":"stdout","output_type":"stream","text":["[LightGBM] [Info] Total Bins 1114\n","[LightGBM] [Info] Number of data points in the train set: 1872, number of used features: 13\n","[LightGBM] [Info] Start training from score 2634.583844\n","Training until validation scores don't improve for 300 rounds\n","Did not meet early stopping. Best iteration is:\n","[75]\ttraining's l2: 7974.77\tvalid_1's l2: 28508.9\n"]},{"data":{"text/html":["\u003cstyle\u003e#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}\u003c/style\u003e\u003cdiv id=\"sk-container-id-1\" class=\"sk-top-container\"\u003e\u003cdiv class=\"sk-text-repr-fallback\"\u003e\u003cpre\u003eLGBMRegressor(force_row_wise=True, objective=\u0026#x27;regression\u0026#x27;, random_state=42)\u003c/pre\u003e\u003cb\u003eIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. \u003cbr /\u003eOn GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\u003c/b\u003e\u003c/div\u003e\u003cdiv class=\"sk-container\" hidden\u003e\u003cdiv class=\"sk-item\"\u003e\u003cdiv class=\"sk-estimator sk-toggleable\"\u003e\u003cinput class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked\u003e\u003clabel for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\"\u003eLGBMRegressor\u003c/label\u003e\u003cdiv class=\"sk-toggleable__content\"\u003e\u003cpre\u003eLGBMRegressor(force_row_wise=True, objective=\u0026#x27;regression\u0026#x27;, random_state=42)\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e"],"text/plain":["LGBMRegressor(force_row_wise=True, objective='regression', random_state=42)"]},"execution_count":25,"metadata":{},"output_type":"execute_result"}],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":26,"metadata":{"executionInfo":{"elapsed":1537,"status":"ok","timestamp":1692536687812,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rl9hM7MyBUvf"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":27,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":138,"status":"ok","timestamp":1692536687813,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"PgZW24H6BV7d","outputId":"b7a33645-7067-46ff-c63f-748884e73cdd"},"outputs":[{"data":{"text/plain":["2.514578402787776"]},"execution_count":27,"metadata":{},"output_type":"execute_result"}],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":28,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":101,"status":"ok","timestamp":1692536687816,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"X-CFyj-kBlwN","outputId":"49278c69-4d94-47c0-e5d8-3e49c82ca2de"},"outputs":[{"name":"stdout","output_type":"stream","text":["[LightGBM] [Info] Total Bins 1117\n","[LightGBM] [Info] Number of data points in the train set: 2040, number of used features: 13\n","[LightGBM] [Info] Start training from score 2653.021410\n"]},{"data":{"text/plain":["(168,)"]},"execution_count":28,"metadata":{},"output_type":"execute_result"}],"source":["model.fit(train_x, train_y)\n","y_pred = model.predict(test_x)\n","y_pred.shape"]},{"cell_type":"code","execution_count":28,"metadata":{"executionInfo":{"elapsed":115,"status":"ok","timestamp":1692536687842,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rlZT9kUCBtp5"},"outputs":[],"source":[]},{"cell_type":"markdown","metadata":{"id":"M9sCOLnBBt0E"},"source":["## 2"]},{"cell_type":"code","execution_count":28,"metadata":{"executionInfo":{"elapsed":115,"status":"ok","timestamp":1692536687842,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"X7CO4vJYB9fj"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":29,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":115,"status":"ok","timestamp":1692536687843,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vAhbV0mM7lcX","outputId":"d279a651-936a-4819-e318-cf1f4f625b48"},"outputs":[{"data":{"text/plain":["Index(['energy_consum', 'day_hour_mean', 'discomfort_CDH', 'week', 'sin_time',\n","       'cos_week', 'THI', 'hour', 'day', 'wind_ms', 'temp', 'month',\n","       'humidity', 'precip', 'building_num'],\n","      dtype='object')"]},"execution_count":29,"metadata":{},"output_type":"execute_result"}],"source":["train_ft_2.columns"]},{"cell_type":"code","execution_count":30,"metadata":{"executionInfo":{"elapsed":104,"status":"ok","timestamp":1692536687843,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"o95yS69GBt0E"},"outputs":[],"source":["# train_drop_cols = ['energy_consum','building_num'] # day_hour mean 만 남김\n","# train_drop_cols = ['building_num', 'day_of_year', 'energy_consum',\n","#        'hour_mean', 'day_hour_median', 'day_hour_mode', 'day_hour_std',\n","#        'discomfort_CDH', 'CDH', 'discomfort', 'week', 'cos_week', 'sin_time']\n","\n","# test_drop_cols = ['building_num', 'day_of_year',\n","#        'hour_mean', 'day_hour_median', 'day_hour_mode', 'day_hour_std',\n","#        'discomfort_CDH', 'CDH', 'discomfort', 'week', 'cos_week', 'sin_time']\n","\n","train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":31,"metadata":{"executionInfo":{"elapsed":103,"status":"ok","timestamp":1692536687843,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"caJwKtvpBt0F"},"outputs":[],"source":["train_x = train_ft_2.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_2['energy_consum']\n","\n","test_x = test_df_2.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":32,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":104,"status":"ok","timestamp":1692536687844,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kwwijy-FBt0F","outputId":"107d0ca8-7468-4626-a46a-6c226c0d7a68"},"outputs":[{"data":{"text/plain":["((1872, 13), (168, 13), (1872,), (168,))"]},"execution_count":32,"metadata":{},"output_type":"execute_result"}],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":33,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":178},"executionInfo":{"elapsed":95,"status":"ok","timestamp":1692536687844,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ar8SWElGBt0H","outputId":"c8ebfced-b80c-42b9-e248-e017dc0357cf"},"outputs":[{"name":"stdout","output_type":"stream","text":["[LightGBM] [Info] Total Bins 1110\n","[LightGBM] [Info] Number of data points in the train set: 1872, number of used features: 13\n","[LightGBM] [Info] Start training from score 1673.842404\n","Training until validation scores don't improve for 300 rounds\n","Did not meet early stopping. Best iteration is:\n","[90]\ttraining's l2: 5509.43\tvalid_1's l2: 40183\n"]},{"data":{"text/html":["\u003cstyle\u003e#sk-container-id-2 {color: black;background-color: white;}#sk-container-id-2 pre{padding: 0;}#sk-container-id-2 div.sk-toggleable {background-color: white;}#sk-container-id-2 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-2 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-2 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-2 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-2 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-2 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-2 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-2 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-2 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-2 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-2 div.sk-item {position: relative;z-index: 1;}#sk-container-id-2 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-2 div.sk-item::before, #sk-container-id-2 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-2 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-2 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-2 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-2 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-2 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-2 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-2 div.sk-label-container {text-align: center;}#sk-container-id-2 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-2 div.sk-text-repr-fallback {display: none;}\u003c/style\u003e\u003cdiv id=\"sk-container-id-2\" class=\"sk-top-container\"\u003e\u003cdiv class=\"sk-text-repr-fallback\"\u003e\u003cpre\u003eLGBMRegressor(force_row_wise=True, objective=\u0026#x27;regression\u0026#x27;, random_state=42)\u003c/pre\u003e\u003cb\u003eIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. \u003cbr /\u003eOn GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\u003c/b\u003e\u003c/div\u003e\u003cdiv class=\"sk-container\" hidden\u003e\u003cdiv class=\"sk-item\"\u003e\u003cdiv class=\"sk-estimator sk-toggleable\"\u003e\u003cinput class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" checked\u003e\u003clabel for=\"sk-estimator-id-2\" class=\"sk-toggleable__label sk-toggleable__label-arrow\"\u003eLGBMRegressor\u003c/label\u003e\u003cdiv class=\"sk-toggleable__content\"\u003e\u003cpre\u003eLGBMRegressor(force_row_wise=True, objective=\u0026#x27;regression\u0026#x27;, random_state=42)\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e"],"text/plain":["LGBMRegressor(force_row_wise=True, objective='regression', random_state=42)"]},"execution_count":33,"metadata":{},"output_type":"execute_result"}],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":34,"metadata":{"executionInfo":{"elapsed":80,"status":"ok","timestamp":1692536687849,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"crXW5DnIBt0I"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":35,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":86,"status":"ok","timestamp":1692536687856,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"NQUUhoSuBt0I","outputId":"3ab64236-8bc9-4f08-fbb2-ac607bdadb4d"},"outputs":[{"data":{"text/plain":["4.521492845152022"]},"execution_count":35,"metadata":{},"output_type":"execute_result"}],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":36,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1774,"status":"ok","timestamp":1692536689556,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"bxh3AoL28b9P","outputId":"3345b69d-2c7c-40c3-c846-0ebc5383b3e6"},"outputs":[{"name":"stdout","output_type":"stream","text":["[LightGBM] [Info] Total Bins 1112\n","[LightGBM] [Info] Number of data points in the train set: 2040, number of used features: 13\n","[LightGBM] [Info] Start training from score 1677.016677\n"]},{"data":{"text/plain":["(336,)"]},"execution_count":36,"metadata":{},"output_type":"execute_result"}],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((y_pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"code","execution_count":36,"metadata":{"executionInfo":{"elapsed":326,"status":"ok","timestamp":1692536689557,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"k5uaMvkP0FW0"},"outputs":[],"source":[]},{"cell_type":"markdown","metadata":{"id":"36aXOHzk8X4t"},"source":["## 3"]},{"cell_type":"code","execution_count":37,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":325,"status":"ok","timestamp":1692536689557,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"WYiXBGQB81x5","outputId":"29a5428b-d424-45e9-d669-034afa7ab824"},"outputs":[{"data":{"text/plain":["Index(['energy_consum', 'day_hour_mean', 'discomfort_CDH', 'week', 'sin_time',\n","       'cos_week', 'THI', 'hour', 'day', 'wind_ms', 'temp', 'month',\n","       'humidity', 'precip', 'building_num'],\n","      dtype='object')"]},"execution_count":37,"metadata":{},"output_type":"execute_result"}],"source":["train_ft_3.columns"]},{"cell_type":"code","execution_count":729,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":617},"executionInfo":{"elapsed":488,"status":"ok","timestamp":1692538063756,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"3uFLqquUIO2v","outputId":"003d0fa5-c81f-4070-8481-b1bbb7f0f809"},"outputs":[{"data":{"text/html":["\n","  \u003cdiv id=\"df-f763bd04-4b95-46c4-afd9-fc2afb77600d\" class=\"colab-df-container\"\u003e\n","    \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003enum_date_time\u003c/th\u003e\n","      \u003cth\u003ebuilding_num\u003c/th\u003e\n","      \u003cth\u003edate_time\u003c/th\u003e\n","      \u003cth\u003etemp\u003c/th\u003e\n","      \u003cth\u003eprecip\u003c/th\u003e\n","      \u003cth\u003ewind_ms\u003c/th\u003e\n","      \u003cth\u003ehumidity\u003c/th\u003e\n","      \u003cth\u003esunshine\u003c/th\u003e\n","      \u003cth\u003esolar_rad\u003c/th\u003e\n","      \u003cth\u003eenergy_consum\u003c/th\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003cth\u003esin_day_of_year\u003c/th\u003e\n","      \u003cth\u003ecos_weekday\u003c/th\u003e\n","      \u003cth\u003esin_weekday\u003c/th\u003e\n","      \u003cth\u003ecos_week\u003c/th\u003e\n","      \u003cth\u003esin_week\u003c/th\u003e\n","      \u003cth\u003ecos_month\u003c/th\u003e\n","      \u003cth\u003esin_month\u003c/th\u003e\n","      \u003cth\u003eday_hour_median\u003c/th\u003e\n","      \u003cth\u003eday_hour_std\u003c/th\u003e\n","      \u003cth\u003eday_hour_mode\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4080\u003c/th\u003e\n","      \u003ctd\u003e3_20220601 00\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e20220601 00\u003c/td\u003e\n","      \u003ctd\u003e18.6\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e0.9\u003c/td\u003e\n","      \u003ctd\u003e42.0\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e926.28\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e0.008607\u003c/td\u003e\n","      \u003ctd\u003e-0.222521\u003c/td\u003e\n","      \u003ctd\u003e0.974928\u003c/td\u003e\n","      \u003ctd\u003e-1.000000\u003c/td\u003e\n","      \u003ctd\u003e8.572528e-16\u003c/td\u003e\n","      \u003ctd\u003e-1.0\u003c/td\u003e\n","      \u003ctd\u003e1.224647e-16\u003c/td\u003e\n","      \u003ctd\u003e954.72\u003c/td\u003e\n","      \u003ctd\u003e129.458256\u003c/td\u003e\n","      \u003ctd\u003e803.16\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4081\u003c/th\u003e\n","      \u003ctd\u003e3_20220601 01\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e20220601 01\u003c/td\u003e\n","      \u003ctd\u003e18.0\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1.1\u003c/td\u003e\n","      \u003ctd\u003e45.0\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e884.52\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e0.008607\u003c/td\u003e\n","      \u003ctd\u003e-0.222521\u003c/td\u003e\n","      \u003ctd\u003e0.974928\u003c/td\u003e\n","      \u003ctd\u003e-1.000000\u003c/td\u003e\n","      \u003ctd\u003e8.572528e-16\u003c/td\u003e\n","      \u003ctd\u003e-1.0\u003c/td\u003e\n","      \u003ctd\u003e1.224647e-16\u003c/td\u003e\n","      \u003ctd\u003e906.48\u003c/td\u003e\n","      \u003ctd\u003e129.659518\u003c/td\u003e\n","      \u003ctd\u003e756.72\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4082\u003c/th\u003e\n","      \u003ctd\u003e3_20220601 02\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e20220601 02\u003c/td\u003e\n","      \u003ctd\u003e17.7\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1.5\u003c/td\u003e\n","      \u003ctd\u003e45.0\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e882.36\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e0.008607\u003c/td\u003e\n","      \u003ctd\u003e-0.222521\u003c/td\u003e\n","      \u003ctd\u003e0.974928\u003c/td\u003e\n","      \u003ctd\u003e-1.000000\u003c/td\u003e\n","      \u003ctd\u003e8.572528e-16\u003c/td\u003e\n","      \u003ctd\u003e-1.0\u003c/td\u003e\n","      \u003ctd\u003e1.224647e-16\u003c/td\u003e\n","      \u003ctd\u003e885.24\u003c/td\u003e\n","      \u003ctd\u003e132.166466\u003c/td\u003e\n","      \u003ctd\u003e742.32\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4083\u003c/th\u003e\n","      \u003ctd\u003e3_20220601 03\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e20220601 03\u003c/td\u003e\n","      \u003ctd\u003e16.7\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1.4\u003c/td\u003e\n","      \u003ctd\u003e48.0\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e867.24\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e0.008607\u003c/td\u003e\n","      \u003ctd\u003e-0.222521\u003c/td\u003e\n","      \u003ctd\u003e0.974928\u003c/td\u003e\n","      \u003ctd\u003e-1.000000\u003c/td\u003e\n","      \u003ctd\u003e8.572528e-16\u003c/td\u003e\n","      \u003ctd\u003e-1.0\u003c/td\u003e\n","      \u003ctd\u003e1.224647e-16\u003c/td\u003e\n","      \u003ctd\u003e867.24\u003c/td\u003e\n","      \u003ctd\u003e123.879882\u003c/td\u003e\n","      \u003ctd\u003e749.16\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4084\u003c/th\u003e\n","      \u003ctd\u003e3_20220601 04\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e20220601 04\u003c/td\u003e\n","      \u003ctd\u003e18.4\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e2.8\u003c/td\u003e\n","      \u003ctd\u003e43.0\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e880.92\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e0.008607\u003c/td\u003e\n","      \u003ctd\u003e-0.222521\u003c/td\u003e\n","      \u003ctd\u003e0.974928\u003c/td\u003e\n","      \u003ctd\u003e-1.000000\u003c/td\u003e\n","      \u003ctd\u003e8.572528e-16\u003c/td\u003e\n","      \u003ctd\u003e-1.0\u003c/td\u003e\n","      \u003ctd\u003e1.224647e-16\u003c/td\u003e\n","      \u003ctd\u003e841.68\u003c/td\u003e\n","      \u003ctd\u003e126.119482\u003c/td\u003e\n","      \u003ctd\u003e754.56\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e6115\u003c/th\u003e\n","      \u003ctd\u003e3_20220824 19\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e20220824 19\u003c/td\u003e\n","      \u003ctd\u003e25.5\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e2.9\u003c/td\u003e\n","      \u003ctd\u003e63.0\u003c/td\u003e\n","      \u003ctd\u003e0.1\u003c/td\u003e\n","      \u003ctd\u003e0.19\u003c/td\u003e\n","      \u003ctd\u003e2729.16\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e-0.854322\u003c/td\u003e\n","      \u003ctd\u003e-0.222521\u003c/td\u003e\n","      \u003ctd\u003e0.974928\u003c/td\u003e\n","      \u003ctd\u003e-0.568065\u003c/td\u003e\n","      \u003ctd\u003e-8.229839e-01\u003c/td\u003e\n","      \u003ctd\u003e-0.5\u003c/td\u003e\n","      \u003ctd\u003e-8.660254e-01\u003c/td\u003e\n","      \u003ctd\u003e2623.32\u003c/td\u003e\n","      \u003ctd\u003e616.760618\u003c/td\u003e\n","      \u003ctd\u003e1164.60\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e6116\u003c/th\u003e\n","      \u003ctd\u003e3_20220824 20\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e20220824 20\u003c/td\u003e\n","      \u003ctd\u003e25.0\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e2.6\u003c/td\u003e\n","      \u003ctd\u003e66.0\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","      \u003ctd\u003e0.01\u003c/td\u003e\n","      \u003ctd\u003e2664.00\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e-0.854322\u003c/td\u003e\n","      \u003ctd\u003e-0.222521\u003c/td\u003e\n","      \u003ctd\u003e0.974928\u003c/td\u003e\n","      \u003ctd\u003e-0.568065\u003c/td\u003e\n","      \u003ctd\u003e-8.229839e-01\u003c/td\u003e\n","      \u003ctd\u003e-0.5\u003c/td\u003e\n","      \u003ctd\u003e-8.660254e-01\u003c/td\u003e\n","      \u003ctd\u003e2559.24\u003c/td\u003e\n","      \u003ctd\u003e633.380662\u003c/td\u003e\n","      \u003ctd\u003e1147.68\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e6117\u003c/th\u003e\n","      \u003ctd\u003e3_20220824 21\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e20220824 21\u003c/td\u003e\n","      \u003ctd\u003e24.6\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1.3\u003c/td\u003e\n","      \u003ctd\u003e67.0\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e2135.16\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e-0.854322\u003c/td\u003e\n","      \u003ctd\u003e-0.222521\u003c/td\u003e\n","      \u003ctd\u003e0.974928\u003c/td\u003e\n","      \u003ctd\u003e-0.568065\u003c/td\u003e\n","      \u003ctd\u003e-8.229839e-01\u003c/td\u003e\n","      \u003ctd\u003e-0.5\u003c/td\u003e\n","      \u003ctd\u003e-8.660254e-01\u003c/td\u003e\n","      \u003ctd\u003e2202.84\u003c/td\u003e\n","      \u003ctd\u003e595.619730\u003c/td\u003e\n","      \u003ctd\u003e988.56\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e6118\u003c/th\u003e\n","      \u003ctd\u003e3_20220824 22\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e20220824 22\u003c/td\u003e\n","      \u003ctd\u003e24.1\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e2.1\u003c/td\u003e\n","      \u003ctd\u003e70.0\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1158.84\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e-0.854322\u003c/td\u003e\n","      \u003ctd\u003e-0.222521\u003c/td\u003e\n","      \u003ctd\u003e0.974928\u003c/td\u003e\n","      \u003ctd\u003e-0.568065\u003c/td\u003e\n","      \u003ctd\u003e-8.229839e-01\u003c/td\u003e\n","      \u003ctd\u003e-0.5\u003c/td\u003e\n","      \u003ctd\u003e-8.660254e-01\u003c/td\u003e\n","      \u003ctd\u003e1158.84\u003c/td\u003e\n","      \u003ctd\u003e313.771116\u003c/td\u003e\n","      \u003ctd\u003e1163.88\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e6119\u003c/th\u003e\n","      \u003ctd\u003e3_20220824 23\u003c/td\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e20220824 23\u003c/td\u003e\n","      \u003ctd\u003e23.8\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1.4\u003c/td\u003e\n","      \u003ctd\u003e70.0\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1025.28\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e-0.854322\u003c/td\u003e\n","      \u003ctd\u003e-0.222521\u003c/td\u003e\n","      \u003ctd\u003e0.974928\u003c/td\u003e\n","      \u003ctd\u003e-0.568065\u003c/td\u003e\n","      \u003ctd\u003e-8.229839e-01\u003c/td\u003e\n","      \u003ctd\u003e-0.5\u003c/td\u003e\n","      \u003ctd\u003e-8.660254e-01\u003c/td\u003e\n","      \u003ctd\u003e1009.80\u003c/td\u003e\n","      \u003ctd\u003e143.378420\u003c/td\u003e\n","      \u003ctd\u003e865.44\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e2040 rows × 46 columns\u003c/p\u003e\n","\u003c/div\u003e\n","    \u003cdiv class=\"colab-df-buttons\"\u003e\n","\n","  \u003cdiv class=\"colab-df-container\"\u003e\n","    \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f763bd04-4b95-46c4-afd9-fc2afb77600d')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\"\u003e\n","\n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\"\u003e\n","    \u003cpath d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/\u003e\n","  \u003c/svg\u003e\n","    \u003c/button\u003e\n","\n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","    \u003cscript\u003e\n","      const buttonEl =\n","        document.querySelector('#df-f763bd04-4b95-46c4-afd9-fc2afb77600d button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-f763bd04-4b95-46c4-afd9-fc2afb77600d');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    \u003c/script\u003e\n","  \u003c/div\u003e\n","\n","\n","\u003cdiv id=\"df-0d946142-7c90-49ff-bc10-a6c183d8ec3c\"\u003e\n","  \u003cbutton class=\"colab-df-quickchart\" onclick=\"quickchart('df-0d946142-7c90-49ff-bc10-a6c183d8ec3c')\"\n","            title=\"Suggest charts.\"\n","            style=\"display:none;\"\u003e\n","\n","\u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\"\u003e\n","    \u003cg\u003e\n","        \u003cpath d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/\u003e\n","    \u003c/g\u003e\n","\u003c/svg\u003e\n","  \u003c/button\u003e\n","\n","\u003cstyle\u003e\n","  .colab-df-quickchart {\n","    background-color: #E8F0FE;\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: #1967D2;\n","    height: 32px;\n","    padding: 0 0 0 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: #E2EBFA;\n","    box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: #174EA6;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","    background-color: #3B4455;\n","    fill: #D2E3FC;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart:hover {\n","    background-color: #434B5C;\n","    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","    fill: #FFFFFF;\n","  }\n","\u003c/style\u003e\n","\n","  \u003cscript\u003e\n","    async function quickchart(key) {\n","      const charts = await google.colab.kernel.invokeFunction(\n","          'suggestCharts', [key], {});\n","    }\n","    (() =\u003e {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-0d946142-7c90-49ff-bc10-a6c183d8ec3c button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  \u003c/script\u003e\n","\u003c/div\u003e\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n"],"text/plain":["      num_date_time  building_num    date_time  temp  precip  wind_ms  \\\n","4080  3_20220601 00             3  20220601 00  18.6     NaN      0.9   \n","4081  3_20220601 01             3  20220601 01  18.0     NaN      1.1   \n","4082  3_20220601 02             3  20220601 02  17.7     NaN      1.5   \n","4083  3_20220601 03             3  20220601 03  16.7     NaN      1.4   \n","4084  3_20220601 04             3  20220601 04  18.4     NaN      2.8   \n","...             ...           ...          ...   ...     ...      ...   \n","6115  3_20220824 19             3  20220824 19  25.5     NaN      2.9   \n","6116  3_20220824 20             3  20220824 20  25.0     NaN      2.6   \n","6117  3_20220824 21             3  20220824 21  24.6     NaN      1.3   \n","6118  3_20220824 22             3  20220824 22  24.1     NaN      2.1   \n","6119  3_20220824 23             3  20220824 23  23.8     NaN      1.4   \n","\n","      humidity  sunshine  solar_rad  energy_consum  ... sin_day_of_year  \\\n","4080      42.0       NaN        NaN         926.28  ...        0.008607   \n","4081      45.0       NaN        NaN         884.52  ...        0.008607   \n","4082      45.0       NaN        NaN         882.36  ...        0.008607   \n","4083      48.0       NaN        NaN         867.24  ...        0.008607   \n","4084      43.0       NaN        NaN         880.92  ...        0.008607   \n","...        ...       ...        ...            ...  ...             ...   \n","6115      63.0       0.1       0.19        2729.16  ...       -0.854322   \n","6116      66.0       0.0       0.01        2664.00  ...       -0.854322   \n","6117      67.0       NaN        NaN        2135.16  ...       -0.854322   \n","6118      70.0       NaN        NaN        1158.84  ...       -0.854322   \n","6119      70.0       NaN        NaN        1025.28  ...       -0.854322   \n","\n","      cos_weekday  sin_weekday  cos_week      sin_week  cos_month  \\\n","4080    -0.222521     0.974928 -1.000000  8.572528e-16       -1.0   \n","4081    -0.222521     0.974928 -1.000000  8.572528e-16       -1.0   \n","4082    -0.222521     0.974928 -1.000000  8.572528e-16       -1.0   \n","4083    -0.222521     0.974928 -1.000000  8.572528e-16       -1.0   \n","4084    -0.222521     0.974928 -1.000000  8.572528e-16       -1.0   \n","...           ...          ...       ...           ...        ...   \n","6115    -0.222521     0.974928 -0.568065 -8.229839e-01       -0.5   \n","6116    -0.222521     0.974928 -0.568065 -8.229839e-01       -0.5   \n","6117    -0.222521     0.974928 -0.568065 -8.229839e-01       -0.5   \n","6118    -0.222521     0.974928 -0.568065 -8.229839e-01       -0.5   \n","6119    -0.222521     0.974928 -0.568065 -8.229839e-01       -0.5   \n","\n","         sin_month  day_hour_median  day_hour_std  day_hour_mode  \n","4080  1.224647e-16           954.72    129.458256         803.16  \n","4081  1.224647e-16           906.48    129.659518         756.72  \n","4082  1.224647e-16           885.24    132.166466         742.32  \n","4083  1.224647e-16           867.24    123.879882         749.16  \n","4084  1.224647e-16           841.68    126.119482         754.56  \n","...            ...              ...           ...            ...  \n","6115 -8.660254e-01          2623.32    616.760618        1164.60  \n","6116 -8.660254e-01          2559.24    633.380662        1147.68  \n","6117 -8.660254e-01          2202.84    595.619730         988.56  \n","6118 -8.660254e-01          1158.84    313.771116        1163.88  \n","6119 -8.660254e-01          1009.80    143.378420         865.44  \n","\n","[2040 rows x 46 columns]"]},"execution_count":729,"metadata":{},"output_type":"execute_result"}],"source":["train_df_3"]},{"cell_type":"code","execution_count":745,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":568,"status":"ok","timestamp":1692539192644,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"4PC3hGOCIl2c","outputId":"eea1003b-7b1f-4491-e5bd-9a3e8071d198"},"outputs":[{"name":"stderr","output_type":"stream","text":["\u003cipython-input-745-ff0872891e9c\u003e:1: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  train_df_3['date_time'] = pd.to_datetime(train_df_3['date_time'])\n","\u003cipython-input-745-ff0872891e9c\u003e:3: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  train_ft_3['day_of_year'] = result\n"]}],"source":["\n","train_df_3['date_time'] = pd.to_datetime(train_df_3['date_time'])\n","result = train_df_3['date_time'].dt.dayofyear\n","train_ft_3['day_of_year'] = result"]},{"cell_type":"code","execution_count":753,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4152,"status":"ok","timestamp":1692539369914,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_0NSZlFkKJbg"},"outputs":[{"name":"stderr","output_type":"stream","text":["\u003cipython-input-753-b5067b60d100\u003e:2: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  train_ft_3['weekday_hol']  = result\n"]}],"source":["result = train_df_3.groupby('day')['energy_consum'].std() * train_df_3.groupby('day_of_year')['energy_consum'].std()\n","train_ft_3['weekday_hol']  = result\n","\n","# train_df_3.groupby('day')['energy_consum'].std()"]},{"cell_type":"code","execution_count":754,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":290,"status":"ok","timestamp":1692539373681,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zRG44OPhIlSj"},"outputs":[{"data":{"text/plain":["day_of_year\n","152    456.492985\n","153    556.048031\n","154    561.629713\n","155    467.089584\n","156    463.399042\n","          ...    \n","232    648.928368\n","233    549.568408\n","234    197.557136\n","235    661.279411\n","236    533.805457\n","Name: energy_consum, Length: 85, dtype: float64"]},"execution_count":740,"metadata":{},"output_type":"execute_result"}],"source":["train_df_3.groupby('day_of_year')['energy_consum'].std()\n"]},{"cell_type":"code","execution_count":755,"metadata":{"executionInfo":{"elapsed":260,"status":"ok","timestamp":1692539373683,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ARI2-P4l81x9"},"outputs":[],"source":["# # train_drop_cols = ['energy_consum','building_num'] # day_hour mean 만 남김\n","# train_drop_cols = ['building_num', 'day_of_year', 'energy_consum',\n","#        'hour_mean', 'day_hour_median', 'day_hour_mode', 'day_hour_std',\n","#        'discomfort_CDH', 'CDH', 'discomfort', 'week', 'cos_week', 'sin_time']\n","\n","# test_drop_cols = ['building_num', 'day_of_year',\n","#        'hour_mean', 'day_hour_median', 'day_hour_mode', 'day_hour_std',\n","#        'discomfort_CDH', 'CDH', 'discomfort', 'week', 'cos_week', 'sin_time']\n","\n","train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":756,"metadata":{"executionInfo":{"elapsed":260,"status":"ok","timestamp":1692539373684,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rXipza7v81x-"},"outputs":[],"source":["train_x = train_ft_3.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_3['energy_consum']\n","\n","test_x = test_df_3.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":757,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":260,"status":"ok","timestamp":1692539373685,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tlGDKR7gHsmG","outputId":"183116dc-13aa-465f-edd7-84b994c40b02"},"outputs":[{"data":{"text/plain":["((1872, 15), (168, 15), (1872,), (168,))"]},"execution_count":757,"metadata":{},"output_type":"execute_result"}],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":758,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":178},"executionInfo":{"elapsed":245,"status":"ok","timestamp":1692539373686,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Ux8tSoD3HsmI","outputId":"ee386956-ffb4-45de-eb87-3b5bf18fe0ea"},"outputs":[{"name":"stdout","output_type":"stream","text":["[LightGBM] [Info] Total Bins 1193\n","[LightGBM] [Info] Number of data points in the train set: 1872, number of used features: 14\n","[LightGBM] [Info] Start training from score 1451.631827\n","Training until validation scores don't improve for 300 rounds\n","Did not meet early stopping. Best iteration is:\n","[15]\ttraining's l2: 46774.2\tvalid_1's l2: 50632.9\n"]},{"data":{"text/html":["\u003cstyle\u003e#sk-container-id-102 {color: black;background-color: white;}#sk-container-id-102 pre{padding: 0;}#sk-container-id-102 div.sk-toggleable {background-color: white;}#sk-container-id-102 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-102 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-102 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-102 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-102 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-102 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-102 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-102 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-102 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-102 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-102 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-102 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-102 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-102 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-102 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-102 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-102 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-102 div.sk-item {position: relative;z-index: 1;}#sk-container-id-102 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-102 div.sk-item::before, #sk-container-id-102 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-102 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-102 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-102 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-102 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-102 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-102 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-102 div.sk-label-container {text-align: center;}#sk-container-id-102 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-102 div.sk-text-repr-fallback {display: none;}\u003c/style\u003e\u003cdiv id=\"sk-container-id-102\" class=\"sk-top-container\"\u003e\u003cdiv class=\"sk-text-repr-fallback\"\u003e\u003cpre\u003eLGBMRegressor(force_row_wise=True, objective=\u0026#x27;regression\u0026#x27;, random_state=42)\u003c/pre\u003e\u003cb\u003eIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. \u003cbr /\u003eOn GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\u003c/b\u003e\u003c/div\u003e\u003cdiv class=\"sk-container\" hidden\u003e\u003cdiv class=\"sk-item\"\u003e\u003cdiv class=\"sk-estimator sk-toggleable\"\u003e\u003cinput class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-102\" type=\"checkbox\" checked\u003e\u003clabel for=\"sk-estimator-id-102\" class=\"sk-toggleable__label sk-toggleable__label-arrow\"\u003eLGBMRegressor\u003c/label\u003e\u003cdiv class=\"sk-toggleable__content\"\u003e\u003cpre\u003eLGBMRegressor(force_row_wise=True, objective=\u0026#x27;regression\u0026#x27;, random_state=42)\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e"],"text/plain":["LGBMRegressor(force_row_wise=True, objective='regression', random_state=42)"]},"execution_count":758,"metadata":{},"output_type":"execute_result"}],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":759,"metadata":{"executionInfo":{"elapsed":221,"status":"ok","timestamp":1692539373687,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"7VT8tTIHHsmI"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":760,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":220,"status":"ok","timestamp":1692539373687,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"liEwyKCkHsmJ","outputId":"7ee7b590-cb63-46d8-e4fa-d808e1469c51"},"outputs":[{"data":{"text/plain":["7.316079684194402"]},"execution_count":760,"metadata":{},"output_type":"execute_result"}],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":761,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/","height":419},"executionInfo":{"elapsed":181,"status":"error","timestamp":1692539373688,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EnPkI6QK-El5"},"outputs":[{"name":"stdout","output_type":"stream","text":["[LightGBM] [Info] Total Bins 1203\n","[LightGBM] [Info] Number of data points in the train set: 2040, number of used features: 14\n","[LightGBM] [Info] Start training from score 1444.078501\n"]},{"ename":"ValueError","evalue":"ignored","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m\u003cipython-input-847-819aeb196270\u003e\u001b[0m in \u001b[0;36m\u003ccell line: 2\u003e\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtrain_x\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtrain_y\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----\u003e 2\u001b[0;31m \u001b[0mpred\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mconcatenate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpred\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtest_x\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0mpred\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/lightgbm/sklearn.py\u001b[0m in \u001b[0;36mpredict\u001b[0;34m(self, X, raw_score, start_iteration, num_iteration, pred_leaf, pred_contrib, validate_features, **kwargs)\u001b[0m\n\u001b[1;32m    892\u001b[0m         \u001b[0mn_features\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mX\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    893\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_n_features\u001b[0m \u001b[0;34m!=\u001b[0m \u001b[0mn_features\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--\u003e 894\u001b[0;31m             raise ValueError(\"Number of features of the model must \"\n\u001b[0m\u001b[1;32m    895\u001b[0m                              \u001b[0;34mf\"match the input. Model n_features_ is {self._n_features} and \"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    896\u001b[0m                              f\"input n_features is {n_features}\")\n","\u001b[0;31mValueError\u001b[0m: Number of features of the model must match the input. Model n_features_ is 15 and input n_features is 13"]}],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n","\n"]},{"cell_type":"markdown","metadata":{"id":"lAUmPwS2LAcY"},"source":["## 4"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":162,"status":"aborted","timestamp":1692539373688,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"7RWo9SELLAcZ"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":161,"status":"aborted","timestamp":1692539373688,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Les-NQM4LAcZ"},"outputs":[],"source":["train_x = train_ft_4.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_4['energy_consum']\n","\n","test_x = test_df_4.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":162,"status":"aborted","timestamp":1692539373689,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_StXPW7eLAca"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":168,"status":"aborted","timestamp":1692539373695,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0bKfYvoVLAca"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":170,"status":"aborted","timestamp":1692539373697,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"f9WBFhTBLAca"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":170,"status":"aborted","timestamp":1692539373697,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"NQbBTfFcLAcb"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":170,"status":"aborted","timestamp":1692539373697,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zwtDVeTbLGmS"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"jwVsHq7oLIcd"},"source":["## 5"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":170,"status":"aborted","timestamp":1692539373698,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ZTG1KgtVLIce"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":170,"status":"aborted","timestamp":1692539373698,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"xeTsZBexLIce"},"outputs":[],"source":["train_x = train_ft_5.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_5['energy_consum']\n","\n","test_x = test_df_5.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":171,"status":"aborted","timestamp":1692539373699,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"CCLcYFbYLIce"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":171,"status":"aborted","timestamp":1692539373699,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EMukr-tLLIcf"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":171,"status":"aborted","timestamp":1692539373699,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"H7HL5K4kLIcf"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":181,"status":"aborted","timestamp":1692539373709,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"x72anuLlLIcf"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":185,"status":"aborted","timestamp":1692539373714,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qc22_KHrLOdd"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"d5usZXOELPsG"},"source":["## 6\n","\n","1.   항목 추가\n","2.   항목 추가\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":185,"status":"aborted","timestamp":1692539373714,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_mb5B5fMLPsH"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":183,"status":"aborted","timestamp":1692539373715,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"XlvBRA7NLPsH"},"outputs":[],"source":["train_x = train_ft_6.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_6['energy_consum']\n","\n","test_x = test_df_6.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":183,"status":"aborted","timestamp":1692539373715,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"5bIPHXboLPsH"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":184,"status":"aborted","timestamp":1692539373716,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"V4hEOYOzLPsI"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":185,"status":"aborted","timestamp":1692539373718,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"82j_CAtMLPsI"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":186,"status":"aborted","timestamp":1692539373719,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Rwf9-LBfLPsI"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":183,"status":"aborted","timestamp":1692539373719,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"k0FGRwOzLU1t"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"6VPwaffVLWFj"},"source":["## 7"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":184,"status":"aborted","timestamp":1692539373720,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ykL3bYk-_tt4"},"outputs":[],"source":["train_ft.columns"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":183,"status":"aborted","timestamp":1692539373720,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"9NU4dfDULWFj"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":183,"status":"aborted","timestamp":1692539373720,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1MszeKKOLWFk"},"outputs":[],"source":["train_x = train_ft_7.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_7['energy_consum']\n","\n","test_x = test_df_7.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":184,"status":"aborted","timestamp":1692539373721,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"HKDJAbX2LWFl"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":182,"status":"aborted","timestamp":1692539373721,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"DQl0sfF6LWFl"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":182,"status":"aborted","timestamp":1692539373721,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"5B4_cJTbLWFn"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":182,"status":"aborted","timestamp":1692539373721,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uVa-u5FnLWFo"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":183,"status":"aborted","timestamp":1692539373722,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"MQzT-8KkLbqz"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"vX_A7WNzLcQN"},"source":["## 8"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":182,"status":"aborted","timestamp":1692539373722,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6aR-HYEeLcQN"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":182,"status":"aborted","timestamp":1692539373722,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"coSAxVNiLcQO"},"outputs":[],"source":["train_x = train_ft_8.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_8['energy_consum']\n","\n","test_x = test_df_8.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":183,"status":"aborted","timestamp":1692539373723,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Uo55zvmWLcQO"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":182,"status":"aborted","timestamp":1692539373723,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uAwIoxsMLcQP"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":182,"status":"aborted","timestamp":1692539373723,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Hf1j6IXgLcQP"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":182,"status":"aborted","timestamp":1692539373723,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"FwrIwF9yLcQQ"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":182,"status":"aborted","timestamp":1692539373724,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"OHuS4MDOLiRD"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"oAkd5Zu9Ljag"},"source":["## 9"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":182,"status":"aborted","timestamp":1692539373724,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"KuQlL8cvLjah"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":181,"status":"aborted","timestamp":1692539373724,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"gGFHeTuTLjah"},"outputs":[],"source":["train_x = train_ft_9.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_9['energy_consum']\n","\n","test_x = test_df_1.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":181,"status":"aborted","timestamp":1692539373724,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"--9MRONZLjah"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":181,"status":"aborted","timestamp":1692539373725,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"bZLOgxKpLjak"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":175,"status":"aborted","timestamp":1692539373740,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"gnMIJvVXLjal"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":176,"status":"aborted","timestamp":1692539373741,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"v-0u3uc7Ljal"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":173,"status":"aborted","timestamp":1692539373741,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"G3G1UxYvLqKS"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"oUc3oJbwLrCE"},"source":["## 10"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":173,"status":"aborted","timestamp":1692539373741,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"l6EXqtmgLrCF"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":196,"status":"aborted","timestamp":1692539373764,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pkt4VrtSLrCF"},"outputs":[],"source":["train_x = train_ft_10.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_10['energy_consum']\n","\n","test_x = test_df_10.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":195,"status":"aborted","timestamp":1692539373764,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"fVHgv-HULrCF"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":195,"status":"aborted","timestamp":1692539373764,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"QFEoOoWkLrCG"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":195,"status":"aborted","timestamp":1692539373765,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uJ2BTmyJLrCG"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":195,"status":"aborted","timestamp":1692539373765,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"K16Vpq_sLrCH"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":198,"status":"aborted","timestamp":1692539373768,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"MgMVz2D_Lw5P"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"k5c-2MKXLygO"},"source":["## 11"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":199,"status":"aborted","timestamp":1692539373769,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ZVdIf41OLygP"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":198,"status":"aborted","timestamp":1692539373769,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"eIvMvmO8LygS"},"outputs":[],"source":["train_x = train_ft_11.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_11['energy_consum']\n","\n","test_x = test_df_11.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":197,"status":"aborted","timestamp":1692539373769,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"IGGslKoaLygT"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":197,"status":"aborted","timestamp":1692539373769,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"SYw7MOPSLygU"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":198,"status":"aborted","timestamp":1692539373770,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tLFfgG9mLygW"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":198,"status":"aborted","timestamp":1692539373770,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"NFK2t_SCLygX"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":197,"status":"aborted","timestamp":1692539373770,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"KGnhyTR_L3FE"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"M6NbaoQoMGu1"},"source":["## 12"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":198,"status":"aborted","timestamp":1692539373771,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vYvMd7YuME97"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":198,"status":"aborted","timestamp":1692539373771,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EpV6XQMMME98"},"outputs":[],"source":["train_x = train_ft_12.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_12['energy_consum']\n","\n","test_x = test_df_12.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":199,"status":"aborted","timestamp":1692539373772,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"E1bkeS5wME98"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":199,"status":"aborted","timestamp":1692539373772,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zWwIh4UcME99"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":199,"status":"aborted","timestamp":1692539373773,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"HeU1TIviME99"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":199,"status":"aborted","timestamp":1692539373773,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zGFxONQZME99"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":198,"status":"aborted","timestamp":1692539373773,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"9uFTDoaxME9-"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"2GeKNnoVML98"},"source":["## 13"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":197,"status":"aborted","timestamp":1692539373773,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"eJx7kHWvML99"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":200,"status":"aborted","timestamp":1692539373776,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"9-X-qH5lML9-"},"outputs":[],"source":["train_x = train_ft_13.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_13['energy_consum']\n","\n","test_x = test_df_13.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":201,"status":"aborted","timestamp":1692539373777,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"9bGwFrO-ML9-"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":201,"status":"aborted","timestamp":1692539373777,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"nkUV9TKFML9-"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":201,"status":"aborted","timestamp":1692539373778,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Qw50HZUAML9_"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":201,"status":"aborted","timestamp":1692539373778,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"UAsPtAJiML9_"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":202,"status":"aborted","timestamp":1692539373779,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0geLWplMMRLk"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"xFftRq0XMR0M"},"source":["## 14"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":200,"status":"aborted","timestamp":1692539373779,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"AFJ5fROAMR0M"},"outputs":[],"source":["# # train_drop_cols = ['energy_consum','building_num']\n","# # test_drop_cols = ['building_num']\n","\n","# train_cols = ['day_hour_mean']\n","# test_cols = ['day_hour_mean']\n","\n","\n","train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":200,"status":"aborted","timestamp":1692539373779,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0k2ARbE_MR0M"},"outputs":[],"source":["train_x = train_ft_14.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_14['energy_consum']\n","\n","test_x = test_df_14.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":201,"status":"aborted","timestamp":1692539373780,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"bCcxFhy1MR0N"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":201,"status":"aborted","timestamp":1692539373780,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"hFcDvQ0aMR0N"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":200,"status":"aborted","timestamp":1692539373780,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"fZeCqusZMR0N"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":200,"status":"aborted","timestamp":1692539373780,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tH-v_lH7MR0P"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":201,"status":"aborted","timestamp":1692539373781,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Q18C_L9vMWKb"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"s_dcbQ_GMX0l"},"source":["## 15"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":201,"status":"aborted","timestamp":1692539373781,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-Va4oluaMX0l"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":204,"status":"aborted","timestamp":1692539373784,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VUdu7njaMX0m"},"outputs":[],"source":["train_x = train_ft_15.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_15['energy_consum']\n","\n","test_x = test_df_15.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":203,"status":"aborted","timestamp":1692539373784,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"HLaiFBvJMX0m"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":203,"status":"aborted","timestamp":1692539373785,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"xFYWIFTcMX0n"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":203,"status":"aborted","timestamp":1692539373785,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"gU2jr08xMX0n"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":202,"status":"aborted","timestamp":1692539373786,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"X7OW8J6RMX0n"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":202,"status":"aborted","timestamp":1692539373786,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"BeSLztS8Mctf"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"7o-BrqaZuIwo"},"source":["## 16"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":202,"status":"aborted","timestamp":1692539373786,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Q01kH0VLMdn-"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":201,"status":"aborted","timestamp":1692539373786,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"DnF6oZUYMdn-"},"outputs":[],"source":["train_x = train_ft_16.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_16['energy_consum']\n","\n","test_x = test_df_16.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31911,"status":"aborted","timestamp":1692539373787,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"4bZ2vyXJMdn-"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31879,"status":"aborted","timestamp":1692539373788,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"mxXj9Vh6Mdn_"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31855,"status":"aborted","timestamp":1692539373789,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0cc1OwsuMdn_"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31843,"status":"aborted","timestamp":1692539373790,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"fb29Y2eIMdoA"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31816,"status":"aborted","timestamp":1692539373792,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6FZLzyRyMm0q"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"jfYLCCJEMnkp"},"source":["## 17"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31792,"status":"aborted","timestamp":1692539373794,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"W10_0vZ2sdAJ"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31787,"status":"aborted","timestamp":1692539373802,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"KBRQzCRJsdAL"},"outputs":[],"source":["train_x = train_ft_17.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_17['energy_consum']\n","\n","test_x = test_df_17.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31773,"status":"aborted","timestamp":1692539373802,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rvA5HeVWMnkq"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31741,"status":"aborted","timestamp":1692539373803,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"PqUC8sa-Mnkr"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31709,"status":"aborted","timestamp":1692539373803,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ht5sCN3SMnkr"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31696,"status":"aborted","timestamp":1692539373803,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qnM3ZqiwMnkr"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31670,"status":"aborted","timestamp":1692539373804,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"h5n3MRNaMtTD"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"mOimVH4rMt8F"},"source":["## 18"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31638,"status":"aborted","timestamp":1692539373804,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"UopEqdK6Mt8F"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31627,"status":"aborted","timestamp":1692539373805,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1o3rwiwbMt8G"},"outputs":[],"source":["train_x = train_ft_18.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_18['energy_consum']\n","\n","test_x = test_df_18.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31614,"status":"aborted","timestamp":1692539373805,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"fln9Ru3yMt8G"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31584,"status":"aborted","timestamp":1692539373807,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"2eolQpvkMt8G"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31558,"status":"aborted","timestamp":1692539373807,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"YTtxIcOMMt8H"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31546,"status":"aborted","timestamp":1692539373808,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TZ39jUhZMt8H"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31520,"status":"aborted","timestamp":1692539373809,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"phwuThLuMyye"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"OIAdE2arMzPB"},"source":["## 19"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31493,"status":"aborted","timestamp":1692539373811,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6SN9rsE0MzPC"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31480,"status":"aborted","timestamp":1692539373811,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Ev5GbluVMzPC"},"outputs":[],"source":["train_x = train_ft_19.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_19['energy_consum']\n","\n","test_x = test_df_19.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31468,"status":"aborted","timestamp":1692539373812,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"W5fj_mZJMzPD"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31435,"status":"aborted","timestamp":1692539373813,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"X7CK0bqkMzPE"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31409,"status":"aborted","timestamp":1692539373813,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uBBE14rJMzPE"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31398,"status":"aborted","timestamp":1692539373814,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ia-1UWd4MzPG"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31373,"status":"aborted","timestamp":1692539373815,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"bbtcPuWfM3T6"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"-M8o5Zf7M34N"},"source":["## 20"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31351,"status":"aborted","timestamp":1692539373816,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"iJG1ZspJM34N"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31340,"status":"aborted","timestamp":1692539373816,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"iG7irhXQM34O"},"outputs":[],"source":["train_x = train_ft_20.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_20['energy_consum']\n","\n","test_x = test_df_20.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31328,"status":"aborted","timestamp":1692539373816,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Fh9-k8wJM34O"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31301,"status":"aborted","timestamp":1692539373816,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zwM1ZcFAM34P"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31278,"status":"aborted","timestamp":1692539373817,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"XkOuX5AjM34P"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31267,"status":"aborted","timestamp":1692539373818,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kn7GtPIVM34P"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31238,"status":"aborted","timestamp":1692539373818,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"X1TKFXTkM8Xd"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"Q9ENsTgKM88j"},"source":["## 21"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31210,"status":"aborted","timestamp":1692539373819,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Z8wIWod0M88k"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31197,"status":"aborted","timestamp":1692539373819,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"mB2L9djDM88l"},"outputs":[],"source":["train_x = train_ft_21.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_21['energy_consum']\n","\n","test_x = test_df_21.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31186,"status":"aborted","timestamp":1692539373819,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ckg6OTxhM88l"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31153,"status":"aborted","timestamp":1692539373819,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"E8UfUcuWM88l"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31126,"status":"aborted","timestamp":1692539373820,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"b06t9h3jM88m"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31114,"status":"aborted","timestamp":1692539373820,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"wrmXnCYqM88m"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31089,"status":"aborted","timestamp":1692539373821,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"UHtYDbngNBsn"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"v2fe_vkcNCaN"},"source":["## 22"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31061,"status":"aborted","timestamp":1692539373823,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"UIipyYC-NCaN"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31050,"status":"aborted","timestamp":1692539373824,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"9-amqdKANCaN"},"outputs":[],"source":["train_x = train_ft_22.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_22['energy_consum']\n","\n","test_x = test_df_22.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31040,"status":"aborted","timestamp":1692539373825,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-Tk59mFkNCaO"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31005,"status":"aborted","timestamp":1692539373825,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6W7_YKIzNCaP"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30979,"status":"aborted","timestamp":1692539373825,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"FYSMokJFNCaP"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30968,"status":"aborted","timestamp":1692539373826,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"5c9AYTH9NCaQ"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30942,"status":"aborted","timestamp":1692539373826,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"R6FelXYUNGsG"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"HXxMvAVJNHVl"},"source":["## 23"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30914,"status":"aborted","timestamp":1692539373827,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EjMvzpG_NHVl"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30902,"status":"aborted","timestamp":1692539373827,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"dR-W0RAMNHVm"},"outputs":[],"source":["train_x = train_ft_12.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_12['energy_consum']\n","\n","test_x = test_df_12.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30888,"status":"aborted","timestamp":1692539373827,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"E2rov6ZWNHVm"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30847,"status":"aborted","timestamp":1692539373828,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"957E38ULNHVm"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30821,"status":"aborted","timestamp":1692539373828,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"k0o8ncYWNHVm"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30799,"status":"aborted","timestamp":1692539373829,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-2x-lLD5NHVn"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30765,"status":"aborted","timestamp":1692539373829,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"feNUat84NL_U"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"5zJ9ehECNMpZ"},"source":["## 24"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30736,"status":"aborted","timestamp":1692539373829,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tATJaGicNMpa"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30743,"status":"aborted","timestamp":1692539373848,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"BeqScn4WNMpa"},"outputs":[],"source":["train_x = train_ft_24.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_24['energy_consum']\n","\n","test_x = test_df_24.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30732,"status":"aborted","timestamp":1692539373848,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"H1YRGS8nNMpb"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30693,"status":"aborted","timestamp":1692539373850,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"xeSGDqTbNMpb"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30672,"status":"aborted","timestamp":1692539373851,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6d63vpW7NMpb"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30659,"status":"aborted","timestamp":1692539373851,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"KXXiNuANNMpb"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30621,"status":"aborted","timestamp":1692539373851,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"mDwqXvzoNQE-"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"ZP3bNWWsNQpA"},"source":["## 25"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30590,"status":"aborted","timestamp":1692539373852,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Jwd6_ucCNQpB"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30577,"status":"aborted","timestamp":1692539373852,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"v2atuCqTNQpB"},"outputs":[],"source":["train_x = train_ft_25.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_25['energy_consum']\n","\n","test_x = test_df_25.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30563,"status":"aborted","timestamp":1692539373852,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VBzgsQzGNQpB"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30537,"status":"aborted","timestamp":1692539373853,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"IWkcC7QTNQpC"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30509,"status":"aborted","timestamp":1692539373853,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"W0YYtcPRNQpC"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30496,"status":"aborted","timestamp":1692539373853,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-IjC-9MfNQpC"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30471,"status":"aborted","timestamp":1692539373856,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"n3QLHy1DNWnw"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"9HJT2WQINXgU"},"source":["## 26"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30442,"status":"aborted","timestamp":1692539373857,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"njgKxVVUNXgV"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30431,"status":"aborted","timestamp":1692539373858,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"mh4a669LNXgV"},"outputs":[],"source":["train_x = train_ft_26.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_26['energy_consum']\n","\n","test_x = test_df_26.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30417,"status":"aborted","timestamp":1692539373858,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"w8oE2TSFNXgV"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30341,"status":"aborted","timestamp":1692539373858,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"nEOuPHQINXgV"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30309,"status":"aborted","timestamp":1692539373858,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"h9soWHsINXgW"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30289,"status":"aborted","timestamp":1692539373859,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"5JeEP7nlNXgW"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30255,"status":"aborted","timestamp":1692539373859,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"hCgIRM--NcLb"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"a0vPRnGCNdXe"},"source":["## 27"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30222,"status":"aborted","timestamp":1692539373860,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tN6rVDFgNdXe"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30209,"status":"aborted","timestamp":1692539373861,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"IuPy5qKRNdXf"},"outputs":[],"source":["train_x = train_ft_27.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_27['energy_consum']\n","\n","test_x = test_df_27.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30194,"status":"aborted","timestamp":1692539373864,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"5MGvjouZNdXf"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30160,"status":"aborted","timestamp":1692539373868,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"JmICs1GJNdXf"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30134,"status":"aborted","timestamp":1692539373869,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TzpsvLA0NdXf"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30122,"status":"aborted","timestamp":1692539373869,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"IjxggKBbNdXh"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30099,"status":"aborted","timestamp":1692539373877,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vAz7Ikc-NjJh"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"Xt5EHKCqNj0C"},"source":["## 28"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30073,"status":"aborted","timestamp":1692539373877,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"DBb7VFbaNj0D"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30062,"status":"aborted","timestamp":1692539373879,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"mVz5aONENj0D"},"outputs":[],"source":["train_x = train_ft_28.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_28['energy_consum']\n","\n","test_x = test_df_28.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30047,"status":"aborted","timestamp":1692539373879,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"SKA_kZzzNj0D"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30015,"status":"aborted","timestamp":1692539373880,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"mIQlvhGSNj0E"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29985,"status":"aborted","timestamp":1692539373880,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"o_aeajtyNj0F"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29971,"status":"aborted","timestamp":1692539373880,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"m9JZpcyGNj0G"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29904,"status":"aborted","timestamp":1692539373881,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"n6VhCgk9NpEs"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"uMzlNABzNp4z"},"source":["## 29"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29875,"status":"aborted","timestamp":1692539373881,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"RjuI9N1gNp40"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29864,"status":"aborted","timestamp":1692539373881,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rmjawssaNp40"},"outputs":[],"source":["train_x = train_ft_29.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_29['energy_consum']\n","\n","test_x = test_df_29.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29852,"status":"aborted","timestamp":1692539373882,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"54UMifmNNp40"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29819,"status":"aborted","timestamp":1692539373882,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uihLfuH2Np41"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29796,"status":"aborted","timestamp":1692539373884,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"k8SYcqjdNp41"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29784,"status":"aborted","timestamp":1692539373884,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"WYDYYniLNp41"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29760,"status":"aborted","timestamp":1692539373885,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"elwLHRwDNwmC"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"ORyU8f06NxOY"},"source":["## 30"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29734,"status":"aborted","timestamp":1692539373885,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pmr9Y2CmNxOZ"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29723,"status":"aborted","timestamp":1692539373887,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zxM2NNdtNxOZ"},"outputs":[],"source":["train_x = train_ft_30.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_30['energy_consum']\n","\n","test_x = test_df_30.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29711,"status":"aborted","timestamp":1692539373887,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"It5pRLThNxOZ"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29680,"status":"aborted","timestamp":1692539373888,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TdhBoV59NxOZ"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29654,"status":"aborted","timestamp":1692539373888,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"G0LZaP8PNxOa"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29640,"status":"aborted","timestamp":1692539373888,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6STtN7cKNxOa"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29611,"status":"aborted","timestamp":1692539373888,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"IBH25DJbN29G"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"tXVHrRJtN3tC"},"source":["## 31"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29584,"status":"aborted","timestamp":1692539373889,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"KwJgNDBYN3tD"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29574,"status":"aborted","timestamp":1692539373890,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"lkrcqKw4N3tD"},"outputs":[],"source":["train_x = train_ft_31.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_31['energy_consum']\n","\n","test_x = test_df_31.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29561,"status":"aborted","timestamp":1692539373890,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"o6EhhBw5N3tE"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31390,"status":"aborted","timestamp":1692539375754,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"2o8bZqdxN3tE"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31364,"status":"aborted","timestamp":1692539375756,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TPh76aTdN3tF"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31352,"status":"aborted","timestamp":1692539375756,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"2RCD9hhfN3tF"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31325,"status":"aborted","timestamp":1692539375757,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"wFrou9zlN6y6"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"6VodApK_N7eF"},"source":["## 32"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31297,"status":"aborted","timestamp":1692539375757,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"iPvS5quMN7eF"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31284,"status":"aborted","timestamp":1692539375757,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1OkIHuMfN7eG"},"outputs":[],"source":["train_x = train_ft_32.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_32['energy_consum']\n","\n","test_x = test_df_32.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31262,"status":"aborted","timestamp":1692539375757,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0_biNRi9N7eG"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31231,"status":"aborted","timestamp":1692539375758,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ND5-oUysN7eG"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31205,"status":"aborted","timestamp":1692539375758,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kmWGjdDON7eG"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31189,"status":"aborted","timestamp":1692539375758,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"wZAIeyTVN7eH"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31160,"status":"aborted","timestamp":1692539375758,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kL-BP07yN_Qd"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"qZqCIwL1N_2Z"},"source":["## 33"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31133,"status":"aborted","timestamp":1692539375759,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"3yjnsh4VN_2Z"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31122,"status":"aborted","timestamp":1692539375759,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vaJF4RvAN_2a"},"outputs":[],"source":["train_x = train_ft_33.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_33['energy_consum']\n","\n","test_x = test_df_33.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31109,"status":"aborted","timestamp":1692539375759,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"u_T7lU7VN_2a"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31078,"status":"aborted","timestamp":1692539375760,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"shhZS6TaN_2b"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31051,"status":"aborted","timestamp":1692539375760,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VvnuOLPDN_2b"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31035,"status":"aborted","timestamp":1692539375760,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1o8UZ1kPN_2b"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":31012,"status":"aborted","timestamp":1692539375762,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"8-wcuAO3ODI7"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"K5nFIE7GODrV"},"source":["## 34"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30983,"status":"aborted","timestamp":1692539375762,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rsGrItWoODrV"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30971,"status":"aborted","timestamp":1692539375763,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"3FKPrhApODrW"},"outputs":[],"source":["train_x = train_ft_34.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_34['energy_consum']\n","\n","test_x = test_df_34.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30959,"status":"aborted","timestamp":1692539375763,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Uj9XP8S9ODrW"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30926,"status":"aborted","timestamp":1692539375763,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"C3sP2d5CODrW"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30899,"status":"aborted","timestamp":1692539375764,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"JPzHHHoXODrW"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30886,"status":"aborted","timestamp":1692539375764,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ss1xBGrhODrX"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30861,"status":"aborted","timestamp":1692539375765,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vrDWpik1OHx-"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"rZxY1iKYOIyb"},"source":["## 35"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30828,"status":"aborted","timestamp":1692539375765,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EkDRHghiOIyb"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30815,"status":"aborted","timestamp":1692539375765,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6LqtJoS7OIyc"},"outputs":[],"source":["train_x = train_ft_35.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_35['energy_consum']\n","\n","test_x = test_df_35.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30800,"status":"aborted","timestamp":1692539375765,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"UDGTAvcOOIyc"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30778,"status":"aborted","timestamp":1692539375766,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ohmIEolDOIyc"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30741,"status":"aborted","timestamp":1692539375766,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zy0OtG6lOIyd"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30729,"status":"aborted","timestamp":1692539375767,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zxntocy9OIyd"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30705,"status":"aborted","timestamp":1692539375768,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"oeGzO9_LOQC0"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"grDm8KYiOQs0"},"source":["## 36"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30677,"status":"aborted","timestamp":1692539375768,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"lTQYw3UUOQs0"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30667,"status":"aborted","timestamp":1692539375769,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"jrfUOK0eOQs1"},"outputs":[],"source":["train_x = train_ft_36.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_36['energy_consum']\n","\n","test_x = test_df_36.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30654,"status":"aborted","timestamp":1692539375769,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1PP0-1KFOQs1"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30620,"status":"aborted","timestamp":1692539375769,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"sF7jUBqROQs1"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30594,"status":"aborted","timestamp":1692539375770,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pssZmnTLOQs2"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30583,"status":"aborted","timestamp":1692539375770,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"CeUN5yu4OQs2"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30556,"status":"aborted","timestamp":1692539375770,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rgrX_6cjOVZ5"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"bVdWnSofOV8r"},"source":["## 37"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30529,"status":"aborted","timestamp":1692539375771,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1cb-bMf9OV8s"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30518,"status":"aborted","timestamp":1692539375771,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LDWwRAZROV8s"},"outputs":[],"source":["train_x = train_ft_37.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_37['energy_consum']\n","\n","test_x = test_df_37.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30506,"status":"aborted","timestamp":1692539375773,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"2uqjU0muOV8t"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30475,"status":"aborted","timestamp":1692539375773,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_JzOw8-aOV8t"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30447,"status":"aborted","timestamp":1692539375774,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"mD0t2nPUOV8t"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30433,"status":"aborted","timestamp":1692539375774,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kk8Xcm3lOV8t"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30408,"status":"aborted","timestamp":1692539375774,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"8sZe8VakOo-k"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"VYHw4XoKOpqU"},"source":["## 38"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30382,"status":"aborted","timestamp":1692539375775,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1Gm_Rns5OpqV"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30371,"status":"aborted","timestamp":1692539375775,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0lHUA5xvOpqV"},"outputs":[],"source":["train_x = train_ft_38.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_38['energy_consum']\n","\n","test_x = test_df_38.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30358,"status":"aborted","timestamp":1692539375775,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"i37W11bbOpqV"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30312,"status":"aborted","timestamp":1692539375775,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"3oiK6zDaOpqW"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30292,"status":"aborted","timestamp":1692539375776,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"lLWbwIwkOpqW"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30277,"status":"aborted","timestamp":1692539375776,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"DzfxShy0OpqW"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30247,"status":"aborted","timestamp":1692539375776,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"F5qABSk7Os_U"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"dPohQZ8bOtiX"},"source":["## 39"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30214,"status":"aborted","timestamp":1692539375776,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"w9PsvS_hOtiY"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30202,"status":"aborted","timestamp":1692539375777,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"2dYb1TpAOtiY"},"outputs":[],"source":["train_x = train_ft_39.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_39['energy_consum']\n","\n","test_x = test_df_39.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30189,"status":"aborted","timestamp":1692539375777,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"JqeQG40dOtiY"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30149,"status":"aborted","timestamp":1692539375777,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"heeSaHFFOtiZ"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30119,"status":"aborted","timestamp":1692539375778,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rW4DC1NjOtiZ"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":30107,"status":"aborted","timestamp":1692539375779,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"iyQDryf_OtiZ"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29982,"status":"aborted","timestamp":1692539375779,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"q-gh5X82OxtY"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"0j0s4mfGOyTF"},"source":["## 40"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29952,"status":"aborted","timestamp":1692539375779,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"AKTVKEmXOyTF"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29921,"status":"aborted","timestamp":1692539375779,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"m6WcbgYNOyTG"},"outputs":[],"source":["train_x = train_ft_40.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_40['energy_consum']\n","\n","test_x = test_df_40.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29902,"status":"aborted","timestamp":1692539375780,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qnwJ8JOMOyTG"},"outputs":[],"source":["\n","# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29864,"status":"aborted","timestamp":1692539375780,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pyEiqSwxOyTG"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29840,"status":"aborted","timestamp":1692539375780,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"FeZVbrLoOyTH"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29829,"status":"aborted","timestamp":1692539375780,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"oFJPNfDcOyTH"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29804,"status":"aborted","timestamp":1692539375781,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"czzXrAfoO3l6"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"6sXCYQIbO4Og"},"source":["## 41"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29779,"status":"aborted","timestamp":1692539375781,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"OrRmVHSEO4Oh"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29767,"status":"aborted","timestamp":1692539375782,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"S35FPa9DO4Oh"},"outputs":[],"source":["train_x = train_ft_41.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_41['energy_consum']\n","\n","test_x = test_df_41.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29753,"status":"aborted","timestamp":1692539375782,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"DIXsCSXaO4Oh"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29720,"status":"aborted","timestamp":1692539375782,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"agFmJrWNO4Oh"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29692,"status":"aborted","timestamp":1692539375783,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"4VBMiBNOO4Oi"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29681,"status":"aborted","timestamp":1692539375784,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-auQtUmfO4Oi"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29640,"status":"aborted","timestamp":1692539375784,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"i1gMEOb-O743"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"YbAaLR_PO8dw"},"source":["## 42"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29609,"status":"aborted","timestamp":1692539375784,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"FWZG4z0gHy76"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29597,"status":"aborted","timestamp":1692539375784,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ipsNz9b7O8dw"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n","\n","# train_cols = ['day_hour_median']\n","# test_cols = ['day_hour_median']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29584,"status":"aborted","timestamp":1692539375785,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VZ_j5qaJO8dz"},"outputs":[],"source":["train_x = train_ft_42.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_42['energy_consum']\n","\n","test_x = test_df_42.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29571,"status":"aborted","timestamp":1692539375785,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ui4du6mVO8d1"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29537,"status":"aborted","timestamp":1692539375785,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Ir_v59ZuO8d1"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29509,"status":"aborted","timestamp":1692539375785,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"nR5ORumGO8d1"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29499,"status":"aborted","timestamp":1692539375786,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"fA0IkSlxO8d2"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29472,"status":"aborted","timestamp":1692539375786,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vjxQCSWaPAH2"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"YhVhCx6bPAnr"},"source":["## 43"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29444,"status":"aborted","timestamp":1692539375786,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"G4zAXuY5PAnr"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29433,"status":"aborted","timestamp":1692539375786,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"bLhzr49zPAns"},"outputs":[],"source":["train_x = train_ft_43.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_43['energy_consum']\n","\n","test_x = test_df_43.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29421,"status":"aborted","timestamp":1692539375787,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LXozvfkRPAns"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29388,"status":"aborted","timestamp":1692539375787,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"xahosFGLPAns"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29360,"status":"aborted","timestamp":1692539375787,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VLgi0xIlPAns"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29347,"status":"aborted","timestamp":1692539375787,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qhxoujmuPAnt"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29324,"status":"aborted","timestamp":1692539375789,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"YiGnjOkSPFLV"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"5PXZm7O-PFyF"},"source":["## 44"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29291,"status":"aborted","timestamp":1692539375789,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"iNkPuvmsPFyF"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29279,"status":"aborted","timestamp":1692539375790,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"FOnSC2NvPFyF"},"outputs":[],"source":["train_x = train_ft_44.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_44['energy_consum']\n","\n","test_x = test_df_44.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29266,"status":"aborted","timestamp":1692539375790,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LCOv8WOxPFyF"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29228,"status":"aborted","timestamp":1692539375790,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"NWNY2H-3PFyG"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29200,"status":"aborted","timestamp":1692539375790,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"8RJ3ZPnnPFyH"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29189,"status":"aborted","timestamp":1692539375790,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"yhOxIjPnPFyH"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29167,"status":"aborted","timestamp":1692539375791,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"WIaXEQm2PKWK"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"Awgj6W_ZPLb8"},"source":["## 45"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29145,"status":"aborted","timestamp":1692539375791,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"PNSFeDhiPLb9"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29133,"status":"aborted","timestamp":1692539375791,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"CGRCkQzuPLb9"},"outputs":[],"source":["train_x = train_ft_45.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_45['energy_consum']\n","\n","test_x = test_df_45.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29123,"status":"aborted","timestamp":1692539375792,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zd2XuHjOPLb9"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29101,"status":"aborted","timestamp":1692539375792,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"wc-HszfaPLb-"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29076,"status":"aborted","timestamp":1692539375792,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"B-aZ173bPLb-"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29064,"status":"aborted","timestamp":1692539375793,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ZInc6gnbPLb-"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29038,"status":"aborted","timestamp":1692539375793,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"u9c296kTPOzm"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"j7J2sznDPPuG"},"source":["## 46"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":29008,"status":"aborted","timestamp":1692539375793,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vpWJ27u9PPuG"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28996,"status":"aborted","timestamp":1692539375795,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tAxAITLrPPuG"},"outputs":[],"source":["train_x = train_ft_46.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_46['energy_consum']\n","\n","test_x = test_df_46.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28983,"status":"aborted","timestamp":1692539375795,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vGtvjjHGPPuH"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28945,"status":"aborted","timestamp":1692539375795,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"WZGsa032PPuH"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28918,"status":"aborted","timestamp":1692539375796,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Bof0qgniPPuH"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28905,"status":"aborted","timestamp":1692539375796,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"h7WN16AyPPuH"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28880,"status":"aborted","timestamp":1692539375797,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"jsG2aKTYPTgc"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"uDryb8eQPUiB"},"source":["## 47"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28848,"status":"aborted","timestamp":1692539375797,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-4e_zPVpPUiC"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28835,"status":"aborted","timestamp":1692539375797,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"RfWFMaRcPUiC"},"outputs":[],"source":["train_x = train_ft_47.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_47['energy_consum']\n","\n","test_x = test_df_47.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28823,"status":"aborted","timestamp":1692539375798,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"u3rVNjoJPUiC"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28791,"status":"aborted","timestamp":1692539375798,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"mZEdmMGwPUiD"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28766,"status":"aborted","timestamp":1692539375798,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"wuKOB5O1PUiD"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28752,"status":"aborted","timestamp":1692539375798,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"8o87l3OFPUiD"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28729,"status":"aborted","timestamp":1692539375799,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"G37h0LjOPYu5"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"rW266aT3PZGH"},"source":["## 48"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28702,"status":"aborted","timestamp":1692539375799,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EDzWGde7PZGJ"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28688,"status":"aborted","timestamp":1692539375800,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pIjo_Nw2PZGJ"},"outputs":[],"source":["train_x = train_ft_48.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_48['energy_consum']\n","\n","test_x = test_df_48.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28675,"status":"aborted","timestamp":1692539375800,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0G5V6Sr3PZGJ"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28640,"status":"aborted","timestamp":1692539375801,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"5a0qIQTLPZGK"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28615,"status":"aborted","timestamp":1692539375801,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uaoenj6aPZGK"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28602,"status":"aborted","timestamp":1692539375801,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"5EHGWMGqPZGK"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28577,"status":"aborted","timestamp":1692539375802,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"H7ylN_ncPd7h"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"SdwQHfq-PehP"},"source":["## 49"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28552,"status":"aborted","timestamp":1692539375802,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"l1pO39QIPehQ"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28539,"status":"aborted","timestamp":1692539375802,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"FAmA504xPehQ"},"outputs":[],"source":["train_x = train_ft_49.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_49['energy_consum']\n","\n","test_x = test_df_49.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28526,"status":"aborted","timestamp":1692539375803,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Q94H1iIEPehR"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28494,"status":"aborted","timestamp":1692539375803,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_Ab9yfjmPehR"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28469,"status":"aborted","timestamp":1692539375803,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"U66Neo9XPehR"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28454,"status":"aborted","timestamp":1692539375803,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pO9-QUqWPehS"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28428,"status":"aborted","timestamp":1692539375804,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"CC4NCSZ3PkBY"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"cZuPR5KUPkr5"},"source":["## 50"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28401,"status":"aborted","timestamp":1692539375804,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TDwTXf1uPkr6"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28389,"status":"aborted","timestamp":1692539375805,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"KHEwNMhkPkr6"},"outputs":[],"source":["train_x = train_ft_50.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_50['energy_consum']\n","\n","test_x = test_df_50.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28375,"status":"aborted","timestamp":1692539375805,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"sy1UJRpmPkr6"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28343,"status":"aborted","timestamp":1692539375806,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"l7M6J7t3Pkr7"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28289,"status":"aborted","timestamp":1692539375806,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"E69Vz270Pkr8"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28276,"status":"aborted","timestamp":1692539375807,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"HEfRV8_JPkr8"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28241,"status":"aborted","timestamp":1692539375807,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"QOKxIRllPosu"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"WwuNcuj4PpiM"},"source":["## 51"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28207,"status":"aborted","timestamp":1692539375807,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"J3KtMbFzPpiM"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28191,"status":"aborted","timestamp":1692539375808,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LBm4Tp0oPpiN"},"outputs":[],"source":["train_x = train_ft_51.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_51['energy_consum']\n","\n","test_x = test_df_51.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28175,"status":"aborted","timestamp":1692539375808,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0oedKT-zPpiN"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28135,"status":"aborted","timestamp":1692539375808,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"XwSOWPLyPpiO"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28099,"status":"aborted","timestamp":1692539375808,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"oTGurlXjPpiO"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28083,"status":"aborted","timestamp":1692539375809,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"92VogK0QPpiO"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28043,"status":"aborted","timestamp":1692539375809,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ahGO5Y-vPtMP"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"nEZiuLIvPtwx"},"source":["## 52"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":28009,"status":"aborted","timestamp":1692539375809,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ybg6iULCPtwy"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27997,"status":"aborted","timestamp":1692539375809,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"AomyB0ARPtwy"},"outputs":[],"source":["train_x = train_ft_52.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_52['energy_consum']\n","\n","test_x = test_df_52.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27966,"status":"aborted","timestamp":1692539375810,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EGqVYyORPtwy"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27934,"status":"aborted","timestamp":1692539375810,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"crVhmCbePtwz"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27910,"status":"aborted","timestamp":1692539375810,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6Rhey5KEPtwz"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27897,"status":"aborted","timestamp":1692539375811,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-Q4SGKhaPtw0"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27828,"status":"aborted","timestamp":1692539375811,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"THgyVqdFPyNz"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"uGUImZjEPz3r"},"source":["## 53"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27803,"status":"aborted","timestamp":1692539375811,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"O7MDIwEnPz3r"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27791,"status":"aborted","timestamp":1692539375811,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1QhC0KaAPz3r"},"outputs":[],"source":["train_x = train_ft_53.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_53['energy_consum']\n","\n","test_x = test_df_53.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27776,"status":"aborted","timestamp":1692539375812,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tNzg3SZvPz3s"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27746,"status":"aborted","timestamp":1692539375813,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"i0Vh2StcPz3s"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27719,"status":"aborted","timestamp":1692539375814,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TpWNzDMfPz3s"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27707,"status":"aborted","timestamp":1692539375814,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VU0lYC4ZPz3t"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27682,"status":"aborted","timestamp":1692539375814,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"XxThBlFZP35Q"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"uIeF8gFEP4n1"},"source":["## 54"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27654,"status":"aborted","timestamp":1692539375814,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"8QQWZVrrtDe8"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27644,"status":"aborted","timestamp":1692539375815,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"bnZuDxbxtDtf"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27631,"status":"aborted","timestamp":1692539375815,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zz3LqDpWtDtg"},"outputs":[],"source":["train_x = train_ft_54.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_54['energy_consum']\n","\n","test_x = test_df_54.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27619,"status":"aborted","timestamp":1692539375815,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"miU_kBMUP4n3"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27590,"status":"aborted","timestamp":1692539375816,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LIvLbFe-P4n4"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27565,"status":"aborted","timestamp":1692539375817,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"iTBVp2IKP4n5"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27551,"status":"aborted","timestamp":1692539375817,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"w3jrWpb6P4n5"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27527,"status":"aborted","timestamp":1692539375818,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"WGzKAWhKQAUK"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"AbNvsPqWQC_o"},"source":["## 55"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27503,"status":"aborted","timestamp":1692539375818,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"8QebSbdYQC_p"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27490,"status":"aborted","timestamp":1692539375818,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"by4_vn78QC_r"},"outputs":[],"source":["train_x = train_ft_55.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_55['energy_consum']\n","\n","test_x = test_df_55.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27477,"status":"aborted","timestamp":1692539375819,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"4uB4XxXuQC_u"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27444,"status":"aborted","timestamp":1692539375819,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"cdjcM_fgQC_u"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27420,"status":"aborted","timestamp":1692539375819,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"8WhDdmxBQC_w"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27407,"status":"aborted","timestamp":1692539375819,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"khyf15fJQC_x"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27386,"status":"aborted","timestamp":1692539375820,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"htQGkiVNQJk3"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"vIS7v5WTQKR3"},"source":["## 56"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27359,"status":"aborted","timestamp":1692539375820,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ZNqPU9AGQKR4"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27347,"status":"aborted","timestamp":1692539375820,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"4pwK7fN6QKR4"},"outputs":[],"source":["train_x = train_ft_56.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_56['energy_consum']\n","\n","test_x = test_df_56.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27327,"status":"aborted","timestamp":1692539375820,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LBdYWGpUQKR5"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27288,"status":"aborted","timestamp":1692539375821,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"90HyesRjQKR5"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27257,"status":"aborted","timestamp":1692539375821,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ZtOJQr1aQKR6"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27244,"status":"aborted","timestamp":1692539375822,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"t-Q3xk2GQKR7"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27214,"status":"aborted","timestamp":1692539375823,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"mATrwJmEQP3-"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"GqzK6NozQQdW"},"source":["## 57"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27190,"status":"aborted","timestamp":1692539375823,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"UTRs5XM8QQdX"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27176,"status":"aborted","timestamp":1692539375823,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"V4OrzLTAQQdX"},"outputs":[],"source":["train_x = train_ft_57.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_57['energy_consum']\n","\n","test_x = test_df_57.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27164,"status":"aborted","timestamp":1692539375824,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"aWLLoNdzQQdX"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27125,"status":"aborted","timestamp":1692539375824,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tw4Wtc9lQQdY"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27099,"status":"aborted","timestamp":1692539375824,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"iNDMOvyBQQdY"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27075,"status":"aborted","timestamp":1692539375825,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"F2RQFpgPQQdY"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27049,"status":"aborted","timestamp":1692539375825,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"PwJep5guQXNA"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"hmQ4Ca77QX95"},"source":["## 58"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27025,"status":"aborted","timestamp":1692539375825,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qCGf0xjaQX95"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":27011,"status":"aborted","timestamp":1692539375825,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TJV7q4xMQX96"},"outputs":[],"source":["train_x = train_ft_58.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_58['energy_consum']\n","\n","test_x = test_df_58.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26999,"status":"aborted","timestamp":1692539375826,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"93tOY_SnQX96"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26967,"status":"aborted","timestamp":1692539375826,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qCJYYNUKQX96"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26941,"status":"aborted","timestamp":1692539375826,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"lGqg_EU2QX97"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26928,"status":"aborted","timestamp":1692539375826,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rpZrZCDMQX97"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26906,"status":"aborted","timestamp":1692539375827,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"8mNb-Le1QdWJ"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"nKq6OMoZQeRd"},"source":["## 59"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26878,"status":"aborted","timestamp":1692539375828,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"AdTFrhfiQeRf"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26865,"status":"aborted","timestamp":1692539375829,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"3gq5gC4nQeRj"},"outputs":[],"source":["train_x = train_ft_59.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_59['energy_consum']\n","\n","test_x = test_df_59.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26852,"status":"aborted","timestamp":1692539375829,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"cRL1Cj2uQeRk"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26831,"status":"aborted","timestamp":1692539375830,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ywwHCdfWQeRk"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26809,"status":"aborted","timestamp":1692539375830,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"GiXTEdsTQeRk"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26794,"status":"aborted","timestamp":1692539375830,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-XnDhvTfQeRl"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26754,"status":"aborted","timestamp":1692539375830,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pfP5UNK5QiQB"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"1AkEgwbaQjCX"},"source":["## 60"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26733,"status":"aborted","timestamp":1692539375831,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"h7UieIkSQjCX"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26721,"status":"aborted","timestamp":1692539375831,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"jcN_O0rIQjCY"},"outputs":[],"source":["train_x = train_ft_60.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_60['energy_consum']\n","\n","test_x = test_df_60.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26710,"status":"aborted","timestamp":1692539375831,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"H7INX5LkQjCY"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26677,"status":"aborted","timestamp":1692539375831,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"dwaXq3mWQjCZ"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26652,"status":"aborted","timestamp":1692539375832,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"idx0C_fIQjCZ"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26639,"status":"aborted","timestamp":1692539375832,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"71P7KsgdQjCZ"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26615,"status":"aborted","timestamp":1692539375832,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"NdDap_e9Qok5"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"SJejzPnnQpu6"},"source":["## 61"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26592,"status":"aborted","timestamp":1692539375833,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kZmV3yusQpu7"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26581,"status":"aborted","timestamp":1692539375833,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"JCO9rCV5QpvB"},"outputs":[],"source":["train_x = train_ft_61.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_61['energy_consum']\n","\n","test_x = test_df_61.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26568,"status":"aborted","timestamp":1692539375833,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qZEeZVOtQpvC"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26536,"status":"aborted","timestamp":1692539375834,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"H5ST-AmBQpvC"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26509,"status":"aborted","timestamp":1692539375834,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ywz3NgC9QpvJ"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26498,"status":"aborted","timestamp":1692539375834,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"IOuJSc8WQpvK"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26473,"status":"aborted","timestamp":1692539375835,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"fZjVIUn-Qx0n"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"1EARbqejQy3p"},"source":["## 62"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26449,"status":"aborted","timestamp":1692539375835,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"lGboam73Qy3q"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26435,"status":"aborted","timestamp":1692539375835,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"YbLWwkfRQy3r"},"outputs":[],"source":["train_x = train_ft_62.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_62['energy_consum']\n","\n","test_x = test_df_62.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26422,"status":"aborted","timestamp":1692539375835,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"7BNJMBm8Qy3r"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26389,"status":"aborted","timestamp":1692539375836,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uNnTFX42Qy3s"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26357,"status":"aborted","timestamp":1692539375836,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"7bWOlHM3Qy3s"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26342,"status":"aborted","timestamp":1692539375836,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0acmIHmIQy3s"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26317,"status":"aborted","timestamp":1692539375836,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"nZLBtRkQQ4Dd"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"qj18sQSqQ5HF"},"source":["## 63"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26285,"status":"aborted","timestamp":1692539375837,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ya75DMroQ5HF"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26267,"status":"aborted","timestamp":1692539375837,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"t9oHR2W9Q5HF"},"outputs":[],"source":["train_x = train_ft_63.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_63['energy_consum']\n","\n","test_x = test_df_63.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26251,"status":"aborted","timestamp":1692539375837,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"yamwSUvwQ5HG"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26208,"status":"aborted","timestamp":1692539375838,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"phY4gq-LQ5HG"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26172,"status":"aborted","timestamp":1692539375838,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"BpVK_ZqmQ5HH"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26150,"status":"aborted","timestamp":1692539375838,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"UhXNv-R4Q5HH"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26120,"status":"aborted","timestamp":1692539375838,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"loBYqCBHQ-AC"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"N_7jtUr_Q-97"},"source":["## 64"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26092,"status":"aborted","timestamp":1692539375839,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"jv7hdSyCQ-97"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26078,"status":"aborted","timestamp":1692539375840,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VusbVW9sQ-98"},"outputs":[],"source":["train_x = train_ft_64.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_64['energy_consum']\n","\n","test_x = test_df_64.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26062,"status":"aborted","timestamp":1692539375840,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"yeOuJ7ofQ-98"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26023,"status":"aborted","timestamp":1692539375841,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"AtdCZTFZQ-98"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25988,"status":"aborted","timestamp":1692539375841,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"aYS_TRdTQ-98"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25972,"status":"aborted","timestamp":1692539375841,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Sbsq6gPQQ-98"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25944,"status":"aborted","timestamp":1692539375841,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"GchGKGHYRDdI"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"PZDDpoffRE3s"},"source":["## 65"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25914,"status":"aborted","timestamp":1692539375842,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"HciaQy8MtPep"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25898,"status":"aborted","timestamp":1692539375842,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"DBoGk790tP-7"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25882,"status":"aborted","timestamp":1692539375842,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VE24peUrtP-8"},"outputs":[],"source":["train_x = train_ft_65.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_65['energy_consum']\n","\n","test_x = test_df_65.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25866,"status":"aborted","timestamp":1692539375842,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"aQhyMK14RE3t"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25831,"status":"aborted","timestamp":1692539375843,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ZJmlsYabRE3t"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25802,"status":"aborted","timestamp":1692539375845,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"KhbW476xRE3t"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25790,"status":"aborted","timestamp":1692539375845,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"cmLSy8pzRE3t"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25759,"status":"aborted","timestamp":1692539375845,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"DfJdoII5RLH-"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"t8vSTUnMRMRK"},"source":["## 66"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25728,"status":"aborted","timestamp":1692539375845,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"I8oc0s4xRMRL"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25694,"status":"aborted","timestamp":1692539375846,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"dlrCujG_RMRL"},"outputs":[],"source":["train_x = train_ft_66.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_66['energy_consum']\n","\n","test_x = test_df_66.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25666,"status":"aborted","timestamp":1692539375846,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"JhyiLk9uRMRM"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25627,"status":"aborted","timestamp":1692539375846,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"XqpoJwo5RMRM"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25596,"status":"aborted","timestamp":1692539375846,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"9swzySNoRMRM"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25579,"status":"aborted","timestamp":1692539375847,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"I5aEZ5O9RMRM"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25551,"status":"aborted","timestamp":1692539375847,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"SUsI-BNRRQfx"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"KoWIa99HRR2L"},"source":["## 67 - THI추가필요"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25515,"status":"aborted","timestamp":1692539375847,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"JRTahEDjtZRQ"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25500,"status":"aborted","timestamp":1692539375847,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qA3bZFtdtZyP"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25488,"status":"aborted","timestamp":1692539375848,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"jVRo1QxptZyQ"},"outputs":[],"source":["train_x = train_ft_67.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_67['energy_consum']\n","\n","test_x = test_df_67.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25476,"status":"aborted","timestamp":1692539375848,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Ryv4pAkzRR2M"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25439,"status":"aborted","timestamp":1692539375848,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"f5TZ6SXoRR2M"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25413,"status":"aborted","timestamp":1692539375849,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6CN1LRCqRR2M"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25396,"status":"aborted","timestamp":1692539375849,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"GLjsr_-oRR2N"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25370,"status":"aborted","timestamp":1692539375849,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ENVrRvHwRWbi"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"ADf1STuARX1c"},"source":["## 68"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25346,"status":"aborted","timestamp":1692539375850,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"g29pyKQ5RX1d"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25332,"status":"aborted","timestamp":1692539375850,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"p50FasIBRX1d"},"outputs":[],"source":["train_x = train_ft_68.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_68['energy_consum']\n","\n","test_x = test_df_68.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25319,"status":"aborted","timestamp":1692539375850,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"hPsy5yRARX1e"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25283,"status":"aborted","timestamp":1692539375850,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_TV-imOiRX1e"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25258,"status":"aborted","timestamp":1692539375851,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"jQ87mC0HRX1f"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25247,"status":"aborted","timestamp":1692539375851,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ATOvkQ9JRX1f"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25220,"status":"aborted","timestamp":1692539375851,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"HJ9KziFXRdmq"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"83TGDZiIRenJ"},"source":["## 69"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25191,"status":"aborted","timestamp":1692539375852,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0hHQsIqRRenJ"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25180,"status":"aborted","timestamp":1692539375852,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"BQlUIfjERenK"},"outputs":[],"source":["train_x = train_ft_69.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_69['energy_consum']\n","\n","test_x = test_df_69.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25165,"status":"aborted","timestamp":1692539375852,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LW0XI3VWRenK"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25133,"status":"aborted","timestamp":1692539375853,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Gvlxn7KCRenL"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25102,"status":"aborted","timestamp":1692539375853,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"H3RxEI9pRenM"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25089,"status":"aborted","timestamp":1692539375853,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"C6CFA4i4RenM"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25065,"status":"aborted","timestamp":1692539375854,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uWA2uu39RkAV"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"f1TkA4TDRlWu"},"source":["## 70"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25034,"status":"aborted","timestamp":1692539375855,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"g-ZMyXslRlWu"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25022,"status":"aborted","timestamp":1692539375856,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-tuFiDI8RlWv"},"outputs":[],"source":["train_x = train_ft_70.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_70['energy_consum']\n","\n","test_x = test_df_70.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25008,"status":"aborted","timestamp":1692539375856,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"j0Y-iEV5RlWv"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24971,"status":"aborted","timestamp":1692539375856,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rrJ35Q_zRlWv"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24947,"status":"aborted","timestamp":1692539375857,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"JQX_IPShRlWw"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24927,"status":"aborted","timestamp":1692539375857,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tuL8RGItRlWw"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24905,"status":"aborted","timestamp":1692539375857,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"aAlYw1YTRqgA"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"SLLJmz1KRr5j"},"source":["## 71"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24882,"status":"aborted","timestamp":1692539375857,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"nPoCpyjtRr5k"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24871,"status":"aborted","timestamp":1692539375858,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pt9FnX2kRr5k"},"outputs":[],"source":["train_x = train_ft_71.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_71['energy_consum']\n","\n","test_x = test_df_71.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24857,"status":"aborted","timestamp":1692539375858,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"S_v-A1uBRr5t"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24826,"status":"aborted","timestamp":1692539375858,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vDbBru5LRr5t"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24798,"status":"aborted","timestamp":1692539375858,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kce8aDOBRr5u"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24788,"status":"aborted","timestamp":1692539375859,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LBtSXHylRr51"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24763,"status":"aborted","timestamp":1692539375859,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-vVjPKmhRw4I"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"qPowR74dRyDf"},"source":["## 72"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24741,"status":"aborted","timestamp":1692539375860,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"4XGuxIbWRyDg"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24728,"status":"aborted","timestamp":1692539375860,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"fDipxoLgRyDg"},"outputs":[],"source":["train_x = train_ft_72.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_72['energy_consum']\n","\n","test_x = test_df_72.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24714,"status":"aborted","timestamp":1692539375860,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EeVjgIkuRyDh"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24686,"status":"aborted","timestamp":1692539375863,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"KMU_yY6hRyDh"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24661,"status":"aborted","timestamp":1692539375864,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"aoMbumZJRyDi"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24648,"status":"aborted","timestamp":1692539375864,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ZAllEBLxRyDi"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24622,"status":"aborted","timestamp":1692539375864,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_7fR0kETR1yu"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"umGbz0IfR2z6"},"source":["## 73"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24599,"status":"aborted","timestamp":1692539375865,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Bg59eo9GR2z6"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24586,"status":"aborted","timestamp":1692539375865,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_3zgQ6bhR2z7"},"outputs":[],"source":["train_x = train_ft_73.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_73['energy_consum']\n","\n","test_x = test_df_73.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24572,"status":"aborted","timestamp":1692539375865,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Ern4fjiYR2z7"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24540,"status":"aborted","timestamp":1692539375865,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"HqQFtnmkR2z7"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24513,"status":"aborted","timestamp":1692539375866,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"4DTBDTv6R2z9"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24500,"status":"aborted","timestamp":1692539375867,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Escrke8VR2z9"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24470,"status":"aborted","timestamp":1692539375868,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kLCVuDI0R7UR"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"j5z3hpLMR8VT"},"source":["## 74"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24437,"status":"aborted","timestamp":1692539375868,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"MSMONorWR8VU"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24422,"status":"aborted","timestamp":1692539375869,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6z60Cr9yR8VU"},"outputs":[],"source":["train_x = train_ft_74.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_74['energy_consum']\n","\n","test_x = test_df_74.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24407,"status":"aborted","timestamp":1692539375870,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"5D7FeySfR8VU"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24378,"status":"aborted","timestamp":1692539375870,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"KFb_G_CLR8VV"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24349,"status":"aborted","timestamp":1692539375870,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"dDL9V0vMR8VV"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24332,"status":"aborted","timestamp":1692539375870,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ep8daoyZR8VW"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24306,"status":"aborted","timestamp":1692539375871,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Okm8gPklSBG4"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"ZP3HL0WTSCUa"},"source":["## 75"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24284,"status":"aborted","timestamp":1692539375871,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"hQub8WekSCUb"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24273,"status":"aborted","timestamp":1692539375872,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"POiE1ZZ_SCUc"},"outputs":[],"source":["train_x = train_ft_75.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_75['energy_consum']\n","\n","test_x = test_df_75.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24263,"status":"aborted","timestamp":1692539375873,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"IwJX0nP9SCUc"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24241,"status":"aborted","timestamp":1692539375874,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"yErSn3AtSCUd"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24220,"status":"aborted","timestamp":1692539375877,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"R_iulYR6SCUd"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24210,"status":"aborted","timestamp":1692539375878,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"BSdad9LYSCUe"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24187,"status":"aborted","timestamp":1692539375878,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"SKkZRIrfSG2n"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"49_5AAuJSIlU"},"source":["## 76"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":6,"status":"aborted","timestamp":1692539378087,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"wjZnG29qSIlV"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":7,"status":"aborted","timestamp":1692539378088,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"NnEYLVhBSIlW"},"outputs":[],"source":["train_x = train_ft_76.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_76['energy_consum']\n","\n","test_x = test_df_76.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":7,"status":"aborted","timestamp":1692539378089,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ahZqZKmRSIlX"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26318,"status":"aborted","timestamp":1692539378089,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"c0iPDHfTSIlY"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26289,"status":"aborted","timestamp":1692539378090,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vplqe90tSIlZ"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26276,"status":"aborted","timestamp":1692539378090,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kVF7HlSwSIlZ"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26250,"status":"aborted","timestamp":1692539378090,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zYTyONiSSNY3"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"6E_cxcANSOny"},"source":["## 77"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26226,"status":"aborted","timestamp":1692539378091,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Eq-64pDiSOny"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26215,"status":"aborted","timestamp":1692539378092,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"A6atp5rwSOnz"},"outputs":[],"source":["train_x = train_ft_77.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_77['energy_consum']\n","\n","test_x = test_df_77.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26203,"status":"aborted","timestamp":1692539378093,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ALQs67-pSOnz"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26173,"status":"aborted","timestamp":1692539378093,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"RSvANZLLSOn0"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26145,"status":"aborted","timestamp":1692539378093,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"92Xn1lb5SOn1"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26113,"status":"aborted","timestamp":1692539378093,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"OIjFJv0CSOn1"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26091,"status":"aborted","timestamp":1692539378094,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"B9KCSQFCSTE_"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"Hyg5K9yYSUXl"},"source":["## 78"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26067,"status":"aborted","timestamp":1692539378094,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6a3S2qOCSUXm"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26057,"status":"aborted","timestamp":1692539378095,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"YZy5wL5ESUXm"},"outputs":[],"source":["train_x = train_ft_78.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_78['energy_consum']\n","\n","test_x = test_df_78.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26044,"status":"aborted","timestamp":1692539378095,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"IdJaIxW7SUXn"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":26014,"status":"aborted","timestamp":1692539378095,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"sj3DkuVXSUXp"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25989,"status":"aborted","timestamp":1692539378095,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EjKDxLnhSUXp"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25977,"status":"aborted","timestamp":1692539378095,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"3FpnAwD8SUXq"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25952,"status":"aborted","timestamp":1692539378097,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rVPlKpbuSZkq"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"dxiWlrXbcub-"},"source":["## 79\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25928,"status":"aborted","timestamp":1692539378097,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vbFNqndjcucA"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25916,"status":"aborted","timestamp":1692539378098,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"IiKz2S1kcucB"},"outputs":[],"source":["train_x = train_ft_79.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_79['energy_consum']\n","\n","test_x = test_df_79.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25903,"status":"aborted","timestamp":1692539378099,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Mcvbk1p2cucB"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25871,"status":"aborted","timestamp":1692539378100,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"W8wqtofwcucD"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25840,"status":"aborted","timestamp":1692539378100,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"gPmOER11cucE"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25825,"status":"aborted","timestamp":1692539378100,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tXyB_pzYcucE"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25800,"status":"aborted","timestamp":1692539378101,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TgrbqgTVNzyn"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"f7D9NJSDSatc"},"source":["## 80"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25770,"status":"aborted","timestamp":1692539378101,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"BeYEEy_dSatd"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25755,"status":"aborted","timestamp":1692539378101,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"BQSieXmOSatd"},"outputs":[],"source":["train_x = train_ft_80.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_80['energy_consum']\n","\n","test_x = test_df_80.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25741,"status":"aborted","timestamp":1692539378102,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"IlM9J_j3Sate"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25709,"status":"aborted","timestamp":1692539378102,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"cB2BbvicSate"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25683,"status":"aborted","timestamp":1692539378102,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rPsKZQV2Satf"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25670,"status":"aborted","timestamp":1692539378103,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"g4BrXTaNSatf"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25644,"status":"aborted","timestamp":1692539378103,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LmohGPz5SiPz"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"Un0XKAR8Sjdm"},"source":["## 81"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25621,"status":"aborted","timestamp":1692539378103,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Cvv5dQV0Sjdm"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25602,"status":"aborted","timestamp":1692539378103,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"iNrYXQ48Sjdn"},"outputs":[],"source":["train_x = train_ft_81.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_81['energy_consum']\n","\n","test_x = test_df_81.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25588,"status":"aborted","timestamp":1692539378103,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"wWXrnKrDSjdn"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25556,"status":"aborted","timestamp":1692539378104,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"edzh_CLqSjdo"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25525,"status":"aborted","timestamp":1692539378104,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"biaHAbBsSjdo"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25510,"status":"aborted","timestamp":1692539378104,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"xqXPXZ0PSjdp"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25487,"status":"aborted","timestamp":1692539378104,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"WvD1fExPSoKY"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"NmF2dKs5Spn0"},"source":["## 82"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25466,"status":"aborted","timestamp":1692539378105,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"DJHlXhJzSpn0"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25453,"status":"aborted","timestamp":1692539378105,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pvpvD1JHSpn1"},"outputs":[],"source":["train_x = train_ft_82.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_82['energy_consum']\n","\n","test_x = test_df_82.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25440,"status":"aborted","timestamp":1692539378106,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"MaE0QWOvSpn1"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25392,"status":"aborted","timestamp":1692539378107,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"fIsADvGtSpn1"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25364,"status":"aborted","timestamp":1692539378107,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"hn2UaXPkSpn1"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25352,"status":"aborted","timestamp":1692539378107,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tRV7kQQ0Spn2"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25331,"status":"aborted","timestamp":1692539378108,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"etMgwThLSugt"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"CqJZqDShSvnB"},"source":["## 83"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25308,"status":"aborted","timestamp":1692539378108,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"MP6XSRwbSvnC"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25296,"status":"aborted","timestamp":1692539378108,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qdeG5eSUSvnC"},"outputs":[],"source":["train_x = train_ft_83.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_83['energy_consum']\n","\n","test_x = test_df_83.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25284,"status":"aborted","timestamp":1692539378108,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1o8B-EDfSvnC"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25263,"status":"aborted","timestamp":1692539378109,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"QRfM711USvnD"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25238,"status":"aborted","timestamp":1692539378109,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"fR6HDtnaSvnD"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25225,"status":"aborted","timestamp":1692539378109,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"YNjM06hnSvnE"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25204,"status":"aborted","timestamp":1692539378109,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"dHNaxonYS0n0"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"b-s8-zWPS129"},"source":["## 84"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25177,"status":"aborted","timestamp":1692539378110,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"3J5foNDOS129"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25163,"status":"aborted","timestamp":1692539378110,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"8gdkN-skS12-"},"outputs":[],"source":["train_x = train_ft_84.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_84['energy_consum']\n","\n","test_x = test_df_84.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25149,"status":"aborted","timestamp":1692539378110,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ppfSiO0_S12-"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25117,"status":"aborted","timestamp":1692539378110,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"JUybNg1TS12-"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25088,"status":"aborted","timestamp":1692539378110,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kqv-JwvZS12_"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25075,"status":"aborted","timestamp":1692539378111,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0NE_9FCYS13A"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25058,"status":"aborted","timestamp":1692539378119,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"3HHF2CI2S65c"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"xCVet622S8WR"},"source":["## 85"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25037,"status":"aborted","timestamp":1692539378120,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-rvMwFwhS8WS"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25023,"status":"aborted","timestamp":1692539378120,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"OR5GPiE4S8WS"},"outputs":[],"source":["train_x = train_ft_85.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_85['energy_consum']\n","\n","test_x = test_df_85.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":25011,"status":"aborted","timestamp":1692539378121,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"SUicBqy8S8WT"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24979,"status":"aborted","timestamp":1692539378121,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"94QlWQClS8WT"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24953,"status":"aborted","timestamp":1692539378122,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ZY6ZovA1S8WU"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24940,"status":"aborted","timestamp":1692539378123,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uj_yqpmWS8WU"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24915,"status":"aborted","timestamp":1692539378123,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"n2n0H7QbTAvt"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"UA826XQcTCH9"},"source":["## 86"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24891,"status":"aborted","timestamp":1692539378123,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"NfBL9WG0TCH-"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24877,"status":"aborted","timestamp":1692539378123,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"jFlcYGzMTCH-"},"outputs":[],"source":["train_x = train_ft_86.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_86['energy_consum']\n","\n","test_x = test_df_86.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24864,"status":"aborted","timestamp":1692539378124,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"c2LftrCnTCH_"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24828,"status":"aborted","timestamp":1692539378124,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VD3yfQbATCIA"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24795,"status":"aborted","timestamp":1692539378124,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"QvQQGEnVTCIA"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24779,"status":"aborted","timestamp":1692539378124,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"NDBtoFChTCIA"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24753,"status":"aborted","timestamp":1692539378125,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"8CQghOSDTHFJ"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"90zqjAcQTIbp"},"source":["## 87"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24725,"status":"aborted","timestamp":1692539378125,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"MooPD6KbTIbp"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24709,"status":"aborted","timestamp":1692539378125,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"dITYfg-BTIbq"},"outputs":[],"source":["train_x = train_ft_87.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_87['energy_consum']\n","\n","test_x = test_df_87.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24691,"status":"aborted","timestamp":1692539378125,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VmjQ_UCETIbq"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24616,"status":"aborted","timestamp":1692539378126,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1vVj0DpaTIbq"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24592,"status":"aborted","timestamp":1692539378126,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"JUeEkH2TTIbr"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24577,"status":"aborted","timestamp":1692539378126,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"liIW04_7TIbr"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24549,"status":"aborted","timestamp":1692539378126,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"0RFnqcLqTOU1"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"zftwndlJTPpC"},"source":["## 88"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24521,"status":"aborted","timestamp":1692539378126,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TS13pcmOtwnP"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24500,"status":"aborted","timestamp":1692539378127,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LfUmcW51txTi"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24483,"status":"aborted","timestamp":1692539378127,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"l6zojyr4txTj"},"outputs":[],"source":["train_x = train_ft_88.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_88['energy_consum']\n","\n","test_x = test_df_88.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24466,"status":"aborted","timestamp":1692539378128,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zb5-U7w2TPpE"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24416,"status":"aborted","timestamp":1692539378129,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pCm-PS2iTPpF"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24383,"status":"aborted","timestamp":1692539378129,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"4mMRJBcXTPpG"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24368,"status":"aborted","timestamp":1692539378129,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"N229cFWBTPpH"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24338,"status":"aborted","timestamp":1692539378130,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"WS75l4RoTTga"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"o5UC7Fw2TU9_"},"source":["## 89"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24313,"status":"aborted","timestamp":1692539378130,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"hZrQiavrTU9_"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24299,"status":"aborted","timestamp":1692539378130,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"6_mkERzGTU-A"},"outputs":[],"source":["train_x = train_ft_89.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_89['energy_consum']\n","\n","test_x = test_df_89.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24285,"status":"aborted","timestamp":1692539378131,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"9flZRoFbTU-A"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24254,"status":"aborted","timestamp":1692539378131,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"xIbC8phITU-B"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24225,"status":"aborted","timestamp":1692539378132,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"7yAnezkoTU-B"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24212,"status":"aborted","timestamp":1692539378133,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ejHr_dj3TU-B"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24188,"status":"aborted","timestamp":1692539378133,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"__Hga_aLTZul"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"5Ly0aSvaTbl5"},"source":["## 90"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24167,"status":"aborted","timestamp":1692539378134,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"XaZN-vzdTbl6"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24155,"status":"aborted","timestamp":1692539378134,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"piflgigOTbl6"},"outputs":[],"source":["train_x = train_ft_90.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_90['energy_consum']\n","\n","test_x = test_df_90.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24142,"status":"aborted","timestamp":1692539378134,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"zlllq8cuTbl7"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24113,"status":"aborted","timestamp":1692539378135,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Hpb8nHmXTbl8"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24085,"status":"aborted","timestamp":1692539378135,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tdyu07juTbl8"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24071,"status":"aborted","timestamp":1692539378135,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"lIPK_VLNTbl9"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24046,"status":"aborted","timestamp":1692539378135,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_ZG1Y8sjTihU"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"aprllvpATlMk"},"source":["## 91"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24022,"status":"aborted","timestamp":1692539378136,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"L_9hqSOyTlMl"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":24006,"status":"aborted","timestamp":1692539378136,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"74RU6ARaTlMl"},"outputs":[],"source":["train_x = train_ft_91.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_91['energy_consum']\n","\n","test_x = test_df_91.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23991,"status":"aborted","timestamp":1692539378136,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"SabSbHieTlMm"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23958,"status":"aborted","timestamp":1692539378136,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"R9ymVjvNTlMm"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23933,"status":"aborted","timestamp":1692539378137,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"rNUHRoRQTlMn"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23919,"status":"aborted","timestamp":1692539378137,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"U_kicVVATlMo"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23895,"status":"aborted","timestamp":1692539378137,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"e0tp00DeTqzb"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"5ilfvewHTsG1"},"source":["## 92"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23871,"status":"aborted","timestamp":1692539378137,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"WE1GCawQTsG2"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23860,"status":"aborted","timestamp":1692539378138,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"lY_6idIWTsG3"},"outputs":[],"source":["train_x = train_ft_92.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_92['energy_consum']\n","\n","test_x = test_df_92.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23846,"status":"aborted","timestamp":1692539378138,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"5hiZQY33TsG3"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23817,"status":"aborted","timestamp":1692539378138,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"jgePJnGRTsG4"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23788,"status":"aborted","timestamp":1692539378138,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EicjsrUETsG5"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23777,"status":"aborted","timestamp":1692539378139,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VLdAORrATsG5"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23755,"status":"aborted","timestamp":1692539378140,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"l1tiiVGkTxj3"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape\n"]},{"cell_type":"markdown","metadata":{"id":"qEFvYKCWTzQv"},"source":["## 93"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23732,"status":"aborted","timestamp":1692539378140,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TroT7oQ_TzQw"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23720,"status":"aborted","timestamp":1692539378140,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1ILwJ4AQTzQw"},"outputs":[],"source":["train_x = train_ft_93.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_93['energy_consum']\n","\n","test_x = test_df_93.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23707,"status":"aborted","timestamp":1692539378140,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"4DoWsIACTzQx"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23676,"status":"aborted","timestamp":1692539378141,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Ihl7L0XuTzQx"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23648,"status":"aborted","timestamp":1692539378141,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ov-DpNP5TzQy"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23636,"status":"aborted","timestamp":1692539378141,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uMwrVRszTzQy"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23613,"status":"aborted","timestamp":1692539378141,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"gjvB09IrT6yj"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"L3S09dRdT8Rm"},"source":["## 94"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23584,"status":"aborted","timestamp":1692539378142,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"VNIfHx46T8Rm"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23565,"status":"aborted","timestamp":1692539378142,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"xe6qTHiDT8Rn"},"outputs":[],"source":["train_x = train_ft_94.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_94['energy_consum']\n","\n","test_x = test_df_94.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23551,"status":"aborted","timestamp":1692539378142,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"cZhmnZuHT8Rn"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23517,"status":"aborted","timestamp":1692539378142,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"vO8hFIbET8Rn"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23489,"status":"aborted","timestamp":1692539378143,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"PRxFV-o_T8Ro"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23475,"status":"aborted","timestamp":1692539378144,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Lg2gXHTOT8Ro"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23449,"status":"aborted","timestamp":1692539378144,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Xa0X75kRUIWN"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"L7nxrm6tUKWB"},"source":["## 95"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23424,"status":"aborted","timestamp":1692539378145,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"9XybIiXsUKWD"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23408,"status":"aborted","timestamp":1692539378145,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"eUPY6W_CUKWD"},"outputs":[],"source":["train_x = train_ft_95.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_95['energy_consum']\n","\n","test_x = test_df_95.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23392,"status":"aborted","timestamp":1692539378145,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"gFRweeXhUKWE"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23359,"status":"aborted","timestamp":1692539378145,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qEBUWW3hUKWF"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23330,"status":"aborted","timestamp":1692539378146,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"9zi_9nWrUKWG"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23305,"status":"aborted","timestamp":1692539378146,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"XD5OPb3LUKWH"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23276,"status":"aborted","timestamp":1692539378146,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"kviLW7JyUWa7"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"_pRpHy1FUYpl"},"source":["## 96"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23250,"status":"aborted","timestamp":1692539378146,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"e9jn4vVVUYpm"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23236,"status":"aborted","timestamp":1692539378146,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"LcvL3ne3UYpm"},"outputs":[],"source":["train_x = train_ft_96.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_96['energy_consum']\n","\n","test_x = test_df_96.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23225,"status":"aborted","timestamp":1692539378147,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"jJjb06j3UYpn"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23195,"status":"aborted","timestamp":1692539378147,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ziD3HD4VUYpo"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23170,"status":"aborted","timestamp":1692539378147,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"GkmRLadoUYpp"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23158,"status":"aborted","timestamp":1692539378147,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"b73xo0szUYpq"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23137,"status":"aborted","timestamp":1692539378148,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qPYXSJfQUioU"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"CJiyVixFUj47"},"source":["## 97"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23114,"status":"aborted","timestamp":1692539378148,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"4CYDWNtkUj47"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23101,"status":"aborted","timestamp":1692539378148,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"CDkFl-9DUj48"},"outputs":[],"source":["train_x = train_ft_97.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_97['energy_consum']\n","\n","test_x = test_df_1.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23090,"status":"aborted","timestamp":1692539378148,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"PfVfS2DSUj48"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23055,"status":"aborted","timestamp":1692539378149,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"uaQGMUQlUj49"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23031,"status":"aborted","timestamp":1692539378150,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ayrd7hw4Uj49"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":23017,"status":"aborted","timestamp":1692539378150,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Z3dI3QA9Uj4-"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22994,"status":"aborted","timestamp":1692539378150,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"URSiLBHAUpsF"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"H-SHKrbGUrCP"},"source":["## 98"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22971,"status":"aborted","timestamp":1692539378150,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"TL0eKaE4UrCQ"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22960,"status":"aborted","timestamp":1692539378151,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Q4sfGlBdUrCQ"},"outputs":[],"source":["train_x = train_ft_98.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_98['energy_consum']\n","\n","test_x = test_df_98.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22945,"status":"aborted","timestamp":1692539378151,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_5jAPk88UrCR"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22913,"status":"aborted","timestamp":1692539378151,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"u1Jmaxu4UrCR"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22882,"status":"aborted","timestamp":1692539378151,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Jxclmi8xUrCS"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22868,"status":"aborted","timestamp":1692539378152,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"3C6tNL5ZUrCT"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22843,"status":"aborted","timestamp":1692539378152,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"pdcJjI0eUvd3"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"15kexbVgUxJI"},"source":["## 99"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22817,"status":"aborted","timestamp":1692539378152,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Y-JsVgXjUxJI"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22801,"status":"aborted","timestamp":1692539378152,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-bkSQnMKUxJJ"},"outputs":[],"source":["train_x = train_ft_99.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_99['energy_consum']\n","\n","test_x = test_df_99.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22788,"status":"aborted","timestamp":1692539378153,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"tXzQ_qmkUxJJ"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22755,"status":"aborted","timestamp":1692539378153,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"R1d8thq1UxJJ"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22728,"status":"aborted","timestamp":1692539378153,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"ECyMMFiPUxJJ"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22714,"status":"aborted","timestamp":1692539378154,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"1jxXHpAfUxJK"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22687,"status":"aborted","timestamp":1692539378154,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"BbW9cN-EU4Ao"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"0Lbz3jdTU5jq"},"source":["## 100"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22660,"status":"aborted","timestamp":1692539378154,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"fkf9yGdGU5jq"},"outputs":[],"source":["train_drop_cols = ['energy_consum','building_num']\n","\n","test_drop_cols = ['building_num']"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22649,"status":"aborted","timestamp":1692539378155,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"Ae5uEJ0qU5jr"},"outputs":[],"source":["train_x = train_ft_100.drop(columns=train_drop_cols,axis=1)\n","train_y = train_ft_100['energy_consum']\n","\n","test_x = test_df_100.drop(columns=test_drop_cols,axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22637,"status":"aborted","timestamp":1692539378156,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"-gunKdzIU5jr"},"outputs":[],"source":["# 마지막 7일을 검증셋으로 설정\n","y_train, y_valid, x_train, x_valid = temporal_train_test_split(y = train_y, X = train_x, test_size = 168)\n","x_train.shape, x_valid.shape, y_train.shape, y_valid.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22606,"status":"aborted","timestamp":1692539378156,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"P5gkdCluU5js"},"outputs":[],"source":["model = LGBMRegressor(random_state=SEED, objective='regression', force_row_wise=True)\n","model.fit(x_train, y_train, eval_set=[(x_train, y_train), (x_valid, y_valid)], callbacks = [early_stopping(300)])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22579,"status":"aborted","timestamp":1692539378157,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"OTh-4RSLU5jt"},"outputs":[],"source":["x_pred = model.predict(x_valid)\n","x_pred = pd.Series(x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22565,"status":"aborted","timestamp":1692539378157,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"EBwQupVnU5jt"},"outputs":[],"source":["_smape(y_valid, x_pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22542,"status":"aborted","timestamp":1692539378157,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"e_yTVzcEU_LD"},"outputs":[],"source":["model.fit(train_x, train_y)\n","pred = np.concatenate((pred, model.predict(test_x)))\n","pred.shape"]},{"cell_type":"markdown","metadata":{"id":"YSo3X9SGw89f"},"source":["# 제출"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22519,"status":"aborted","timestamp":1692539378157,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"qZJBTxBWw_rt"},"outputs":[],"source":["len(pred)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22489,"status":"aborted","timestamp":1692539378158,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"cmn0IDMPxA7k"},"outputs":[],"source":["submission"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22464,"status":"aborted","timestamp":1692539378158,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"enUE9VMRxCxQ"},"outputs":[],"source":["submission['answer'] = pred"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22441,"status":"aborted","timestamp":1692539378158,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"NgQ8tO6exHMw"},"outputs":[],"source":["submission"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"executionInfo":{"elapsed":22414,"status":"aborted","timestamp":1692539378158,"user":{"displayName":"Yeseul Ryu","userId":"01398576250166115600"},"user_tz":-540},"id":"_ZShfDe_xKRx"},"outputs":[],"source":[]}],"metadata":{"colab":{"authorship_tag":"ABX9TyM95MqwH9VWN8Ac7vVRfYCQ","name":"","toc_visible":true,"version":""},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}